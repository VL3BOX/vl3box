(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d4e1588c"],{"2f09":function(t){t.exports=JSON.parse('["未完成","已完成","提现失败","已拒绝"]')},"67ac":function(t,a,e){},"88bc":function(t,a,e){"use strict";e.r(a);e("a4d3"),e("e01a");var s=function(){var t=this,a=t._self._c;return a("div",{staticClass:"m-credit m-packet"},[a("h2",{staticClass:"u-title"},[a("i",{staticClass:"el-icon-present"}),t._v(" "+t._s(t.$t("我的红包")))]),a("div",{staticClass:"m-credit-total m-packet-total"},[t._v(" "+t._s(t.$t("余额"))+" : "),a("b",{class:{hasLeft:t.hasLeft}},[t._v(t._s(t.formatMoney(t.money)))])]),t.showPullBox?a("div",{staticClass:"m-credit-pull m-packet-pull"},[a("el-form",{attrs:{"label-position":"left","label-width":"80px"}},[a("el-form-item",{attrs:{label:t.$t("类型")}},[a("el-select",{attrs:{placeholder:t.$t("请选择")},model:{value:t.pull.pay_type,callback:function(a){t.$set(t.pull,"pay_type",a)},expression:"pull.pay_type"}},t._l(t.pay_types,(function(t,e){return a("el-option",{key:e,attrs:{label:t,value:e}})})),1)],1),a("el-form-item",{attrs:{label:t.$t("账号")}},[a("el-input",{attrs:{placeholder:t.$t("请务必填写正确的收款账号")},model:{value:t.pull.account,callback:function(a){t.$set(t.pull,"account",a)},expression:"pull.account"}})],1),a("el-form-item",{attrs:{label:t.$t("姓名")}},[a("el-input",{attrs:{placeholder:t.$t("请务必填写正确的收款人")},model:{value:t.pull.username,callback:function(a){t.$set(t.pull,"username",a)},expression:"pull.username"}})],1),a("el-form-item",{attrs:{label:""}},[a("el-button",{attrs:{type:"primary",disabled:!t.money||t.lockStatus},on:{click:t.openConfirmBox}},[t._v(t._s(t.$t("提交申请")))])],1)],1)],1):t._e(),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"m-credit-table m-packet-table"},[a("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":t.changeType},model:{value:t.activeName,callback:function(a){t.activeName=a},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:t.$t("红包记录"),name:"my_packet_list"}},[t.my_packet_list&&t.my_packet_list.length?a("div",{staticClass:"m-packet-table"},[a("table",{staticClass:"m-packet-in-list"},[a("tr",[a("th",[t._v(t._s(t.$t("红包金额")))]),a("th",[t._v(t._s(t.$t("红包类型")))]),a("th",[t._v(t._s(t.$t("红包状态")))]),a("th",[t._v(t._s(t.$t("备注")))]),a("th",[t._v(t._s(t.$t("收入时间")))])]),t._l(t.my_packet_list,(function(e,s){return a("tr",{key:s},[a("td",[a("b",[t._v(t._s(t.formatMoney(e.money)))])]),a("td",[t._v(t._s(t.formatType(e.action_type)))]),a("td",[t._v(t._s(e.is_success?t.$t("已处理"):t.$t("未处理")))]),a("td",[t._v(t._s(e.description||e.remark||"-"))]),a("td",[t._v(t._s(t.formatDate(e.created_at)))])])}))],2)]):a("el-alert",{staticClass:"m-credit-null m-packet-null",attrs:{title:t.$t("没有找到相关条目"),type:"info",center:"","show-icon":""}}),a("el-pagination",{staticClass:"m-credit-pages m-packet-pages",attrs:{background:"","page-size":t.per,"hide-on-single-page":!0,"current-page":t.page,layout:"total, prev, pager, next, jumper",total:t.total},on:{"update:currentPage":function(a){t.page=a},"update:current-page":function(a){t.page=a}}})],1)],1)],1)])},n=[],i=(e("99af"),e("14d9"),e("fb6a"),e("a9e3"),e("b680"),e("d3b7"),e("c9d2")),c=e("e4f1"),o=e("41cb");function r(){return Object(o["d"])().get("/api/vip/i")}function l(t){return Object(o["d"])().get("/api/red-packet/log/my",{params:t})}function u(t){return Object(o["d"])().get("/api/cash-out/history",{params:t})}function p(t){return Object(o["d"])().get("/api/red-packet/list",{params:t})}function h(t){return Object(o["d"])().get("/api/cash-out/manage/list",{params:t})}function d(t){return Object(o["d"])().post("/api/cash-out/red-packet",t)}function m(t,a,e){return Object(o["d"])().put("/api/cash-out/manage/".concat(t,"/status"),a,{params:e})}function f(t){return Object(o["d"])().post("/api/red-packet/giving","",{params:t})}function y(t){return Object(o["d"])().delete("/api/red-packet/recycle",{params:t})}var _=e("9deb"),g=e("2f09"),b=e("b776"),k=e("2ef0"),v=e.n(k),$=e("85e4"),x={name:"Packet",props:[],data:function(){return{loading:!1,activeName:"my_packet_list",isSuperAdmin:i["a"].getInfo().group>=512,money:0,my_packet_list:[],my_packet_history:[],all_packet:[],all_history:[],page:1,per:10,total:1,query:{user_id:"",category:"",batch_no:"",status:""},pay_types:_,pull:{pay_type:"alipay",account:"",username:""},showPullBox:!1,lockStatus:!1,paystatus:g,showPushBox:!1,push:{status:"1",why:"",transaction_id:""},checkId:"",checkItem:"",optypes:b,showGiftBox:!1,gift:{category:"",batchNo:"",money:"",ids:"",describe:""}}},computed:{hasLeft:function(){return this.money>0},params:function(){var t=this,a={pageIndex:this.page,pageSize:this.per},e=["user_id","category","batch_no","status"];return e.forEach((function(e){void 0!==t.query[e]&&""!==t.query[e]&&(a[e]=t.query[e])})),a},pulldata:function(){return{username:this.pull.username,account:this.pull.account,pay_type:this.pull.pay_type}},pushdata:function(){return{status:~~this.push.status,why:this.push.why,transaction_id:this.push.transaction_id}},giftdata:function(){var t=v.a.cloneDeep(this.gift);return t.money=100*parseFloat(t.money),t}},methods:{togglePullBox:function(){this.showPullBox=!this.showPullBox},loadData:function(){var t=this;this.loading=!0;var a={my_packet_list:l,my_packet_history:u,all_packet:p,all_history:h};this.$router.push({name:"packet",query:{tab:this.activeName,page:this.page}}),a[this.activeName](this.params).then((function(a){t[t.activeName]=a.data.data.list||[],t.total=a.data.data.page.total})).finally((function(){t.loading=!1}))},changeType:function(){this.page=1,this.$route.query.tab=this.activeName,this.loadData()},openConfirmBox:function(){var t=this;this.$alert('<div class="m-packet-msg">请确认收款账号和收款人 <br/> 收款账号<b>'.concat(this.pull.account,"</b> <br/> 收款人<b>").concat(this.pull.username,"</b></div>"),"确认信息",{confirmButtonText:this.$t("确定"),dangerouslyUseHTMLString:!0,callback:function(a){"confirm"==a&&(t.lockStatus=!0,t.loading=!0,d(t.pulldata).then((function(a){t.$message({type:"success",message:t.$t("申请成功,请耐心等待审核结果")}),t.showPullBox=!1,t.money=0})).finally((function(){t.lockStatus=!1,t.loading=!1})))}})},check:function(t){this.showPushBox=!0,this.checkItem=t,this.checkId=t.id},submit:function(t){var a=this;this.lockStatus=!0,this.loading=!0,m(this.checkId,this.pushdata,this.params).then((function(t){a.showPushBox=!1,a.$message({type:"success",message:a.$t("操作成功")}),a.checkItem.status=a.push.status})).finally((function(){a.lockStatus=!1,a.loading=!1}))},toggleGiftBox:function(){this.showGiftBox=!this.showGiftBox},present:function(){var t=this;this.lockStatus=!0,this.loading=!0,f(this.giftdata).then((function(a){t.showGiftBox=!1,t.$message({type:"success",message:t.$t("发放成功")})})).finally((function(){t.lockStatus=!1,t.loading=!1}))},recycle:function(t){var a=this;y({ids:t.id,reason:i["a"].getInfo().uid}).then((function(e){a.$message({message:a.$t("收回数量")+e.data.data.successCount,type:"success"}),t.status=-1}))},formatType:function(t){var a={1:"领取红包",2:"提现失败返回余额","-1":"回收红包","-2":"提现","-3":"红包过期","-4":"红包消费"};return a[t]},formatDate:function(t){return Object(c["b"])(t)},formatStatus:function(t){return t?"已提现":"未提现"},formatHistoryStatus:function(t){return t?g[t]:"审核中"},formatPaytype:function(t){return t?_[t]:t},encryptAccount:function(t){return t.slice(0,3)+"******"},formatMoney:function(t){return t?(t/100).toFixed(2):0},formatPayStatus:function(t){return t+="",t&&g[t]},authorLink:$["authorLink"]},created:function(){var t=this;this.activeName=this.$route.query.tab||"my_packet_list",this.page=Number(this.$route.query.page||1),r().then((function(a){t.money=a.data.data.red_packet})),this.loadData()},watch:{params:{deep:!0,handler:function(){this.loadData()}}}},w=x,B=(e("c71b"),e("2877")),S=Object(B["a"])(w,s,n,!1,null,null,null);a["default"]=S.exports},"9deb":function(t){t.exports=JSON.parse('{"alipay":"支付宝"}')},b776:function(t){t.exports=JSON.parse('{"1":"支付成功","2":"转账失败,退还金额","3":"拒绝申请,不退还金额"}')},c71b:function(t,a,e){"use strict";e("67ac")}}]);
//# sourceMappingURL=chunk-d4e1588c.171a9aca.js.map