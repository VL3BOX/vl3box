(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7557112c"],{6043:function(t,i,a){"use strict";a("e12a")},"809b":function(t,i,a){"use strict";a.r(i);a("99af"),a("d81d"),a("ac1f"),a("841c");var e=function(){var t=this,i=t._self._c;return i("div",{staticClass:"m-maps"},[i("div",{ref:"mapView",staticClass:"m-maps-pic"},[t.mapId?i("img",{attrs:{src:t.currentMap}}):i("div",{ref:"mapWrap",staticClass:"m-map__wrap",on:{mousedown:t.handleMouseDown,mousemove:t.handleMouseMove,mouseup:t.handleMouseUp,wheel:t.handleWheel}},[i("div",{ref:"map",staticClass:"m-map__world",style:"left:".concat(0*t.elWidth/100,"px;top:").concat(25*t.elHeight/100,"px;transform-origin: ").concat(t.zoomOriginX,"px ").concat(t.zoomOriginY,"px; transform: scale(").concat(t.meter_zoom,");cursor: ").concat(t.isDragging?"grabbing":"grab")},[t._l(t.mapData,(function(a,e){return i("span",{key:e,staticClass:"u-map",style:"left:".concat(a.x||0,"px;top:").concat(a.y||0,"px"),on:{click:function(i){return t.changeMap(a.MapID)}}},[t._v(" "+t._s(a.comment)+" ")])})),i("img",{staticClass:"u-img",staticStyle:{width:"3556px",height:"2195px"},attrs:{src:t.map,alt:t.$t("世界地图")}})],2)])]),i("div",{staticClass:"m-toolbar"},[i("h1",{staticClass:"m-maps__title"},[t._v(t._s(t.title))]),i("el-input",{attrs:{size:"small",clearable:""},model:{value:t.search,callback:function(i){t.search=i},expression:"search"}},[i("template",{slot:"prepend"},[t._v(t._s(t.$t("地图")))])],2),i("el-button-group",[i("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-arrow-left"},on:{click:function(i){return t.changePage("prev")}}},[t._v("上一页")]),i("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(i){return t.changePage("next")}}},[t._v(" 下一页 "),i("i",{staticClass:"el-icon-arrow-right el-icon--right"})])],1),i("div",{staticClass:"u-world-map",on:{click:function(i){return t.changeMap(0)}}},[t._v(t._s(t.$t("世界地图")))]),i("div",{staticClass:"m-mapList"},t._l(t.maps,(function(a){return i("div",{key:a.ID,staticClass:"u-item",attrs:{label:a.MapName,value:a.ID},on:{click:function(i){return t.changeMap(a.ID)}}},[t._v(" "+t._s(a.MapName||a.Name)+" ")])})),0)],1)])},n=[],s=(a("4de4"),a("caad"),a("d3b7"),a("2532"),a("c7eb")),r=a("1da1"),c=a("41cb"),o=Object(c["c"])(),l=function(){var t=Object(r["a"])(Object(s["a"])().mark((function t(i){return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",o.get("/map",{params:i}));case 1:case"end":return t.stop()}}),t)})));return function(i){return t.apply(this,arguments)}}(),p=function(){var t=Object(r["a"])(Object(s["a"])().mark((function t(i){return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",o.get("/map/id-to-point",{params:i}));case 1:case"end":return t.stop()}}),t)})));return function(i){return t.apply(this,arguments)}}(),h=a("65c2"),m={name:"Map",data:function(){return{loading:!1,mapId:0,maps:[],mapData:[],search:"",page:1,per:18,count:0,initWidth:0,initHeight:0,elWidth:0,elHeight:0,meter_zoom:.28,isDragging:!1,dragStartX:0,dragStartY:0,zoomOriginX:0,zoomOriginY:0,click:!1}},computed:{currentMap:function(){return"".concat(h["__imgPath"],"map/maps/map_").concat(this.mapId,"_0.png")},map:function(){return"".concat(h["__imgPath"],"topic/pic/map.jpg?123")},client:function(){return this.$store.state.client},params:function(){var t={per:this.per,page:this.page,client:this.client};return this.search&&(t.search=this.search),t},title:function(){var t=this,i=this.maps.filter((function(i){return i.ID==t.mapId}))[0];return(null===i||void 0===i?void 0:i.Name)||"剑三地图库"}},watch:{params:{deep:!0,handler:function(){this.load()}},mapId:function(t){null!==t&&""!==t&&void 0!==t||(this.mapId=0)}},mounted:function(){this.load(),this.loadOther(),this.initBodySize()},methods:{changeMap:function(t){this.mapId=t,this.rest()},rest:function(){this.meter_zoom=.28,this.zoomOriginX=0,this.zoomOriginY=0,this.click=!1},changePage:function(t){var i=this.page;"prev"===t?i--:i<this.count/this.per&&i++,this.page=i<0?0:i},load:function(){var t=this;this.loading=!0,l(this.params).then((function(i){var a=i.data.data.list||[];t.count=i.data.data.count,t.maps=a.map((function(t){return t.ID||(t.MapName="世界地图"),t}))})).finally((function(){t.loading=!0}))},loadOther:function(){var t=this;p({client:this.client}).then((function(i){var a=i.data.data||[];t.mapData=a.filter((function(t){var i,a;return t.comment&&!(null!==(i=t.comment)&&void 0!==i&&i.includes("测试"))&&t.x<1e4&&t.y<1e4&&t.x>0&&t.y>0&&!(null!==(a=t.comment)&&void 0!==a&&a.includes("扬州_"))})).map((function(t){return t.y=t.y+50,t.x=t.x+150,t}))}))},handleWheel:function(t){var i=t.deltaY||t.detail||t.wheelDelta,a=.05;i<0?(this.meter_zoom+=a,this.meter_zoom>1.8&&(this.meter_zoom=1.8)):(this.meter_zoom-=a,this.meter_zoom<.28&&(this.meter_zoom=.28));var e=this.$refs.mapWrap.getBoundingClientRect(),n=this.click?(t.clientX-e.left)/this.meter_zoom:0,s=this.click?(t.clientY-e.top)/this.meter_zoom:0,r=n-parseFloat(this.$refs.map.style.left),c=s-parseFloat(this.$refs.map.style.top);this.zoomOriginX=r,this.zoomOriginY=c,this.$refs.map.style.transformOrigin="".concat(this.zoomOriginX,"px ").concat(this.zoomOriginY,"px"),this.$refs.map.style.transform="scale(".concat(this.meter_zoom,")"),t.preventDefault()},initBodySize:function(){var t=3556,i=2195;this.initWidth=this.$refs.mapView.clientWidth,this.initHeight=this.initWidth*(i/t),this.elWidth=this.initWidth*(100/(t/2)),this.elHeight=this.initHeight*(100/(i/2))},handleMouseDown:function(t){this.isDragging=!0,this.click=!0,this.dragStartX=t.clientX,this.dragStartY=t.clientY},handleMouseMove:function(t){if(this.isDragging){var i=t.clientX-this.dragStartX,a=t.clientY-this.dragStartY,e=this.$refs.map;e.style.left="".concat(parseFloat(e.style.left)+i,"px"),e.style.top="".concat(parseFloat(e.style.top)+a,"px"),this.dragStartX=t.clientX,this.dragStartY=t.clientY}},handleMouseUp:function(){this.isDragging=!1}}},u=m,d=(a("6043"),a("2877")),g=Object(d["a"])(u,e,n,!1,null,null,null);i["default"]=g.exports},e12a:function(t,i,a){}}]);
//# sourceMappingURL=chunk-7557112c.e441bdf0.js.map