(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3c1a2be3"],{"06e1":function(e,t,n){},"5d74":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"m-search-view"},[e.isEmpty?t("span",{staticClass:"u-list-empty"},[e._v("👻 "+e._s(e.$t("暂无记录")))]):e._e(),e.isLogin&&e.isVirtual&&!e.isEmpty?t("div",{staticClass:"m-normal-op"},[t("el-checkbox",{attrs:{border:"",size:"small"},on:{change:e.switchAll},model:{value:e.isAll,callback:function(t){e.isAll=t},expression:"isAll"}},[e._v(e._s(e.$t("全选")))]),e.selectedAchievements.length?[t("el-button",{attrs:{plain:"",icon:"el-icon-check",size:"small"},on:{click:function(t){return t.stopPropagation(),e.finishVirtual.apply(null,arguments)}}},[e._v(" "+e._s(e.$t("批量设为完成")+"("+e.selectedAchievements.length+")")+" ")]),t("el-button",{attrs:{type:"info",icon:"el-icon-close",size:"small"},on:{click:function(t){return t.stopPropagation(),e.cancelVirtual.apply(null,arguments)}}},[e._v(" "+e._s(e.$t("批量取消完成")+"("+e.selectedAchievements.length+")")+" ")])]:e._e()],2):e._e(),t("Achievements",{attrs:{achievements:e.achievements}}),t("el-pagination",{attrs:{background:"",total:e.achievements_count,"hide-on-single-page":"",layout:"prev, pager, next","current-page":e.page,"page-size":e.length,"prev-html":"&laquo;","next-html":"&raquo;"},on:{"current-change":e.page_change_handle}})],1)},a=[],c=n("c7eb"),s=n("5530"),r=n("1da1"),o=(n("99af"),n("4de4"),n("a630"),n("caad"),n("a15b"),n("d81d"),n("14d9"),n("d3b7"),n("6062"),n("2532"),n("3ca3"),n("ddb0"),n("ba02")),u=n("262e"),l=n("c9d2"),h={name:"SearchPage",components:{Achievements:o["a"]},props:[],data:function(){return{achievements:[],achievements_count:0,page:1,length:15,isAll:!1}},computed:{isEmpty:function(){var e;return!(null!==(e=this.achievements)&&void 0!==e&&e.length)},isLogin:function(){return l["a"].isLogin()},currentRole:function(){return this.$store.state.role},selectedAchievements:function(){return this.achievements.filter((function(e){return e.checked}))},isVirtual:function(){var e;return!(null!==(e=this.currentRole)&&void 0!==e&&e.jx3id)},achievementsVirtual:function(){return this.$store.state.achievementsVirtual}},watch:{$route:{immediate:!0,handler:function(){var e=this;return Object(r["a"])(Object(c["a"])().mark((function t(){var n,i;return Object(c["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.isAll=!1,e.page=parseInt(e.$route.query.page)||1,t.next=4,e.get_achievements(e.$route.params.keyword,e.page,e.length);case 4:n=t.sent,i=n.achievements.map((function(e){return Object(s["a"])(Object(s["a"])({},e),{},{checked:!1})})),e.achievements=i,e.achievements_count=n.total;case 8:case"end":return t.stop()}}),t)})))()}}},methods:{switchAll:function(e){this.achievements=this.achievements.map((function(t){return Object(s["a"])(Object(s["a"])({},t),{},{checked:e})}))},get_achievements:function(e,t,n){var i={keyword:e,page:t};return"undefined"!==typeof n&&(i["limit"]=n),new Promise((function(e,t){Object(u["o"])(i).then((function(t){t=t.data,e(t.data)}),(function(){e(!1)}))}))},page_change_handle:function(e){this.$router.push({name:"search",params:{keyword:this.$route.params.keyword},query:{page:e}})},finishVirtual:function(){var e=this,t=this.selectedAchievements.map((function(e){return e.ID+""})),n={achievements:t.join()};Object(u["p"])(n).then((function(n){e.$notify({title:"操作成功",message:"已将选中成就标记为已完成",type:"success"});var i=Array.from(new Set(e.achievementsVirtual.concat(t)));e.$store.commit("SET_STATE",{key:"achievementsVirtual",value:i}),e.isAll=!1,e.achievements=e.achievements.map((function(e){return Object(s["a"])(Object(s["a"])({},e),{},{checked:!1})}))}))},cancelVirtual:function(){var e=this,t=this.selectedAchievements.map((function(e){return e.ID+""})),n={achievements:t.join()};Object(u["a"])(n).then((function(n){e.$notify({title:"操作成功",message:"已将选中成就标记为待完成",type:"success"});var i=e.achievementsVirtual.filter((function(e){return!t.includes(e)}));e.$store.commit("SET_STATE",{key:"achievementsVirtual",value:i}),e.isAll=!1,e.achievements=e.achievements.map((function(e){return Object(s["a"])(Object(s["a"])({},e),{},{checked:!1})}))}))}}},m=h,p=(n("d949"),n("2877")),v=Object(p["a"])(m,i,a,!1,null,null,null);t["default"]=v.exports},ba02:function(e,t,n){"use strict";var i=function(){var e=this,t=e._self._c;return t("ul",{staticClass:"m-achievement-singles"},e._l(e.achievements,(function(n,i){return t("AchievementSingle",{key:i,attrs:{achievement:n,target:e.target,jump:e.jump,initFold:!0}})})),1)},a=[],c=(n("b0c0"),n("1c47")),s={name:"Achievements",props:["achievements","target","jump"],components:{AchievementSingle:c["a"]},watch:{achievements:function(){var e=this;this.$route&&"undefined"!==typeof this.$store.state.scroll_tops[this.$route.name]&&setTimeout((function(){window.scrollTo(0,e.$store.state.scroll_tops[e.$route.name])}),200)}}},r=s,o=n("2877"),u=Object(o["a"])(r,i,a,!1,null,null,null);t["a"]=u.exports},d949:function(e,t,n){"use strict";n("06e1")}}]);
//# sourceMappingURL=chunk-3c1a2be3.28f40376.js.map