(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d6ec3c3"],{"0906":function(t,e,n){"use strict";n("3863")},"125d":function(t,e,n){"use strict";n("b5d3")},"13d5":function(t,e,n){"use strict";var i=n("23e7"),o=n("d58f").left,r=n("a640"),a=n("2d00"),s=n("605d"),c=!s&&a>79&&a<83,l=c||!r("reduce");i({target:"Array",proto:!0,forced:l},{reduce:function(t){var e=arguments.length;return o(this,t,e,e>1?arguments[1]:void 0)}})},"16f7":function(t,e,n){},"18aa":function(t,e,n){"use strict";n("16f7")},"1cbd":function(t,e,n){"use strict";function i(t,e){return function(){return t.apply(e,arguments)}}n.d(e,"a",(function(){return i}))},"1fda":function(t,e,n){"use strict";n("3c56")},"220a":function(t,e,n){t.exports=n.p+"img/emotion.daf2e421.svg"},"25c3":function(t){t.exports=JSON.parse('["真不错，谢谢楼主#胜利#笨猪#胜利","辛苦了，感谢楼主的付出","谢谢楼主，很有用","剑三真好玩，魔盒真好用"]')},"262e":function(t,e,n){"use strict";n.d(e,"d",(function(){return r})),n.d(e,"m",(function(){return a})),n.d(e,"n",(function(){return s})),n.d(e,"b",(function(){return l})),n.d(e,"f",(function(){return u})),n.d(e,"e",(function(){return d})),n.d(e,"o",(function(){return m})),n.d(e,"g",(function(){return p})),n.d(e,"c",(function(){return h})),n.d(e,"l",(function(){return f})),n.d(e,"i",(function(){return g})),n.d(e,"h",(function(){return y})),n.d(e,"k",(function(){return b})),n.d(e,"p",(function(){return v})),n.d(e,"a",(function(){return w})),n.d(e,"j",(function(){return C}));n("caad"),n("2532");var i=n("41cb"),o=Object(i["d"])();function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"wiki_cj_ac";return Object(i["a"])().get("/api/cms/breadcrumb/".concat(t)).then((function(t){return t.data.data.html||""}))}function a(t,e){return t?o.get("api/node/achievement/".concat(t),e):null}function s(t){return t?o.get("/api/node/achievement/".concat(t,"/relations")):null}var c=location.href.includes("origin")?"origin":"std";function l(){return o.get("/api/node/achievement/count",{params:{client:c}})}function u(t){return o.get("/api/node/achievement/menus",{params:{general:t,client:c}})}function d(t,e){var n="/api/cms/helper/achievements/".concat(t);return e&&(n+="/".concat(e)),Object(i["a"])().get(n,{params:{client:c}})}function m(t){return o.get("/api/node/achievement/search",{params:Object.assign(t,{client:c})})}function p(t){return o.get("/api/node/achievement/newest",{params:{page:t,client:c}})}function h(t){return o.get("/api/node/achievement/adventure",{params:{page:t,client:c}})}function f(t){return Object(i["a"])().get("/api/cms/helper/achievements/waiting",{params:{page:t,client:c}})}function g(t){return o.get("/api/node/achievement/rare",{params:{page:t,client:c}})}function y(t){return Object(i["b"])().get("/api/achievements/out_print",{params:{page:t,client:c}})}function b(){return Object(i["c"])().get("/api/next2/virtual-achievements")}function v(t){return Object(i["c"])().post("/api/next2/virtual-achievements",t)}function w(t){return Object(i["c"])().post("/api/next2/virtual-achievements/cancel",t)}function C(t){return Object(i["c"])().get("/api/next2/user-achievements",{params:{jx3id:t}})}},"34ea":function(t,e,n){"use strict";e["a"]=null},3863:function(t,e,n){},"3c56":function(t,e,n){},"3f99":function(t,e,n){"use strict";(function(t){var i=n("1cbd");const{toString:o}=Object.prototype,{getPrototypeOf:r}=Object,a=(t=>e=>{const n=o.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),s=t=>(t=t.toLowerCase(),e=>a(e)===t),c=t=>e=>typeof e===t,{isArray:l}=Array,u=c("undefined");function d(t){return null!==t&&!u(t)&&null!==t.constructor&&!u(t.constructor)&&f(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const m=s("ArrayBuffer");function p(t){let e;return e="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&m(t.buffer),e}const h=c("string"),f=c("function"),g=c("number"),y=t=>null!==t&&"object"===typeof t,b=t=>!0===t||!1===t,v=t=>{if("object"!==a(t))return!1;const e=r(t);return(null===e||e===Object.prototype||null===Object.getPrototypeOf(e))&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},w=s("Date"),C=s("File"),_=s("Blob"),k=s("FileList"),x=t=>y(t)&&f(t.pipe),S=t=>{let e;return t&&("function"===typeof FormData&&t instanceof FormData||f(t.append)&&("formdata"===(e=a(t))||"object"===e&&f(t.toString)&&"[object FormData]"===t.toString()))},O=s("URLSearchParams"),E=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function L(t,e,{allOwnKeys:n=!1}={}){if(null===t||"undefined"===typeof t)return;let i,o;if("object"!==typeof t&&(t=[t]),l(t))for(i=0,o=t.length;i<o;i++)e.call(null,t[i],i,t);else{const o=n?Object.getOwnPropertyNames(t):Object.keys(t),r=o.length;let a;for(i=0;i<r;i++)a=o[i],e.call(null,t[a],a,t)}}function R(t,e){e=e.toLowerCase();const n=Object.keys(t);let i,o=n.length;while(o-- >0)if(i=n[o],e===i.toLowerCase())return i;return null}const j=(()=>"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:t)(),A=t=>!u(t)&&t!==j;function T(){const{caseless:t}=A(this)&&this||{},e={},n=(n,i)=>{const o=t&&R(e,i)||i;v(e[o])&&v(n)?e[o]=T(e[o],n):v(n)?e[o]=T({},n):l(n)?e[o]=n.slice():e[o]=n};for(let i=0,o=arguments.length;i<o;i++)arguments[i]&&L(arguments[i],n);return e}const P=(t,e,n,{allOwnKeys:o}={})=>(L(e,(e,o)=>{n&&f(e)?t[o]=Object(i["a"])(e,n):t[o]=e},{allOwnKeys:o}),t),F=t=>(65279===t.charCodeAt(0)&&(t=t.slice(1)),t),$=(t,e,n,i)=>{t.prototype=Object.create(e.prototype,i),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},U=(t,e,n,i)=>{let o,a,s;const c={};if(e=e||{},null==t)return e;do{o=Object.getOwnPropertyNames(t),a=o.length;while(a-- >0)s=o[a],i&&!i(s,t,e)||c[s]||(e[s]=t[s],c[s]=!0);t=!1!==n&&r(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},I=(t,e,n)=>{t=String(t),(void 0===n||n>t.length)&&(n=t.length),n-=e.length;const i=t.indexOf(e,n);return-1!==i&&i===n},N=t=>{if(!t)return null;if(l(t))return t;let e=t.length;if(!g(e))return null;const n=new Array(e);while(e-- >0)n[e]=t[e];return n},B=(t=>e=>t&&e instanceof t)("undefined"!==typeof Uint8Array&&r(Uint8Array)),D=(t,e)=>{const n=t&&t[Symbol.iterator],i=n.call(t);let o;while((o=i.next())&&!o.done){const n=o.value;e.call(t,n[0],n[1])}},z=(t,e)=>{let n;const i=[];while(null!==(n=t.exec(e)))i.push(n);return i},H=s("HTMLFormElement"),W=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(t,e,n){return e.toUpperCase()+n})),q=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),M=s("RegExp"),J=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),i={};L(n,(n,o)=>{let r;!1!==(r=e(n,o,t))&&(i[o]=r||n)}),Object.defineProperties(t,i)},V=t=>{J(t,(e,n)=>{if(f(t)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const i=t[n];f(i)&&(e.enumerable=!1,"writable"in e?e.writable=!1:e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))})},K=(t,e)=>{const n={},i=t=>{t.forEach(t=>{n[t]=!0})};return l(t)?i(t):i(String(t).split(e)),n},G=()=>{},X=(t,e)=>(t=+t,Number.isFinite(t)?t:e),Q="abcdefghijklmnopqrstuvwxyz",Y="0123456789",Z={DIGIT:Y,ALPHA:Q,ALPHA_DIGIT:Q+Q.toUpperCase()+Y},tt=(t=16,e=Z.ALPHA_DIGIT)=>{let n="";const{length:i}=e;while(t--)n+=e[Math.random()*i|0];return n};function et(t){return!!(t&&f(t.append)&&"FormData"===t[Symbol.toStringTag]&&t[Symbol.iterator])}const nt=t=>{const e=new Array(10),n=(t,i)=>{if(y(t)){if(e.indexOf(t)>=0)return;if(!("toJSON"in t)){e[i]=t;const o=l(t)?[]:{};return L(t,(t,e)=>{const r=n(t,i+1);!u(r)&&(o[e]=r)}),e[i]=void 0,o}}return t};return n(t,0)},it=s("AsyncFunction"),ot=t=>t&&(y(t)||f(t))&&f(t.then)&&f(t.catch);e["a"]={isArray:l,isArrayBuffer:m,isBuffer:d,isFormData:S,isArrayBufferView:p,isString:h,isNumber:g,isBoolean:b,isObject:y,isPlainObject:v,isUndefined:u,isDate:w,isFile:C,isBlob:_,isRegExp:M,isFunction:f,isStream:x,isURLSearchParams:O,isTypedArray:B,isFileList:k,forEach:L,merge:T,extend:P,trim:E,stripBOM:F,inherits:$,toFlatObject:U,kindOf:a,kindOfTest:s,endsWith:I,toArray:N,forEachEntry:D,matchAll:z,isHTMLForm:H,hasOwnProperty:q,hasOwnProp:q,reduceDescriptors:J,freezeMethods:V,toObjectSet:K,toCamelCase:W,noop:G,toFiniteNumber:X,findKey:R,global:j,isContextDefined:A,ALPHABET:Z,generateString:tt,isSpecCompliantForm:et,toJSONObject:nt,isAsyncFn:it,isThenable:ot}}).call(this,n("c8ba"))},"43c2":function(t,e,n){},4657:function(t,e,n){},5331:function(t,e,n){},"533b":function(t,e,n){},"55ce":function(t,e,n){t.exports=n.p+"img/hide.acfa7848.svg"},"819b":function(t,e,n){t.exports=n.p+"img/comment.2840ad61.svg"},"83b85":function(t,e,n){t.exports=n.p+"img/view.c2d7d5c4.svg"},9045:function(t,e,n){},"9b75":function(t,e,n){"use strict";n("a303")},a135:function(t,e,n){"use strict";n("a88b")},a303:function(t,e,n){},a88b:function(t,e,n){},b143:function(t,e,n){"use strict";n("5331")},b5c8:function(t,e,n){"use strict";n("533b")},b5d3:function(t,e,n){},b716:function(t,e,n){t.exports=n.p+"img/heart_1.60e0229c.svg"},b85c:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));n("a4d3"),n("e01a"),n("d28b"),n("d9e2"),n("d3b7"),n("3ca3"),n("ddb0");var i=n("06c5");function o(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Object(i["a"])(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var o=0,r=function(){};return{s:r,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){c=!0,a=t},f:function(){try{s||null==n["return"]||n["return"]()}finally{if(c)throw a}}}}},bc4e:function(t,e,n){"use strict";n("4657")},d58f:function(t,e,n){"use strict";var i=n("59ed"),o=n("7b0b"),r=n("44ad"),a=n("07fa"),s=TypeError,c="Reduce of empty array with no initial value",l=function(t){return function(e,n,l,u){var d=o(e),m=r(d),p=a(d);if(i(n),0===p&&l<2)throw new s(c);var h=t?p-1:0,f=t?-1:1;if(l<2)while(1){if(h in m){u=m[h],h+=f;break}if(h+=f,t?h<0:p<=h)throw new s(c)}for(;t?h>=0:p>h;h+=f)h in m&&(u=n(u,m[h],h,d));return u}};t.exports={left:l(!1),right:l(!0)}},d790:function(t,e,n){"use strict";(function(t){var i=n("3f99"),o=n("dc93"),r=n("34ea");function a(t){return i["a"].isPlainObject(t)||i["a"].isArray(t)}function s(t){return i["a"].endsWith(t,"[]")?t.slice(0,-2):t}function c(t,e,n){return t?t.concat(e).map((function(t,e){return t=s(t),!n&&e?"["+t+"]":t})).join(n?".":""):e}function l(t){return i["a"].isArray(t)&&!t.some(a)}const u=i["a"].toFlatObject(i["a"],{},null,(function(t){return/^is[A-Z]/.test(t)}));function d(e,n,d){if(!i["a"].isObject(e))throw new TypeError("target must be an object");n=n||new(r["a"]||FormData),d=i["a"].toFlatObject(d,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(t,e){return!i["a"].isUndefined(e[t])}));const m=d.metaTokens,p=d.visitor||v,h=d.dots,f=d.indexes,g=d.Blob||"undefined"!==typeof Blob&&Blob,y=g&&i["a"].isSpecCompliantForm(n);if(!i["a"].isFunction(p))throw new TypeError("visitor must be a function");function b(e){if(null===e)return"";if(i["a"].isDate(e))return e.toISOString();if(!y&&i["a"].isBlob(e))throw new o["a"]("Blob is not supported. Use a Buffer instead.");return i["a"].isArrayBuffer(e)||i["a"].isTypedArray(e)?y&&"function"===typeof Blob?new Blob([e]):t.from(e):e}function v(t,e,o){let r=t;if(t&&!o&&"object"===typeof t)if(i["a"].endsWith(e,"{}"))e=m?e:e.slice(0,-2),t=JSON.stringify(t);else if(i["a"].isArray(t)&&l(t)||(i["a"].isFileList(t)||i["a"].endsWith(e,"[]"))&&(r=i["a"].toArray(t)))return e=s(e),r.forEach((function(t,o){!i["a"].isUndefined(t)&&null!==t&&n.append(!0===f?c([e],o,h):null===f?e:e+"[]",b(t))})),!1;return!!a(t)||(n.append(c(o,e,h),b(t)),!1)}const w=[],C=Object.assign(u,{defaultVisitor:v,convertValue:b,isVisitable:a});function _(t,e){if(!i["a"].isUndefined(t)){if(-1!==w.indexOf(t))throw Error("Circular reference detected in "+e.join("."));w.push(t),i["a"].forEach(t,(function(t,o){const r=!(i["a"].isUndefined(t)||null===t)&&p.call(n,t,i["a"].isString(o)?o.trim():o,e,C);!0===r&&_(t,e?e.concat(o):[o])})),w.pop()}}if(!i["a"].isObject(e))throw new TypeError("data must be an object");return _(e),n}e["a"]=d}).call(this,n("b639").Buffer)},d9e8:function(t,e,n){"use strict";n("9045")},dc93:function(t,e,n){"use strict";var i=n("3f99");function o(t,e,n,i,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),i&&(this.request=i),o&&(this.response=o)}i["a"].inherits(o,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:i["a"].toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const r=o.prototype,a={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{a[t]={value:t}}),Object.defineProperties(o,a),Object.defineProperty(r,"isAxiosError",{value:!0}),o.from=(t,e,n,a,s,c)=>{const l=Object.create(r);return i["a"].toFlatObject(t,l,(function(t){return t!==Error.prototype}),t=>"isAxiosError"!==t),o.call(l,t.message,e,n,a,s),l.cause=t,l.name=t.name,c&&Object.assign(l,c),l},e["a"]=o},e395:function(t,e,n){"use strict";var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-wiki-top"},[e("div",{staticClass:"m-wiki-top__header"},[e("h3",{staticClass:"u-title"},[e("i",{staticClass:"el-icon-news"}),t._v(t._s(t.$t("公告")))])]),e("div",{staticClass:"m-wiki-top__content",domProps:{innerHTML:t._s(t.data)}})])},o=[],r=(n("e9c4"),n("b64b"),n("262e")),a={name:"WikiNotice",data:function(){return{data:[]}},mounted:function(){this.loadData()},methods:{loadData:function(){var t=this;try{var e=sessionStorage.getItem("wiki_cj_ac");e?this.data=JSON.parse(e):Object(r["d"])("wiki_cj_ac").then((function(e){t.data=e,sessionStorage.setItem("wiki_cj_ac",JSON.stringify(t.data))}))}catch(n){this.data=""}}}},s=a,c=(n("9b75"),n("2877")),l=Object(c["a"])(s,i,o,!1,null,null,null);e["a"]=l.exports},e43b:function(t,e,n){"use strict";n("43c2")},e5de:function(t,e,n){t.exports=n.p+"img/heart_2.cc8f76d0.svg"},f636:function(t,e,n){"use strict";n("fb6b")},fb6b:function(t,e,n){},fd85:function(t,e,n){"use strict";n.r(e);var i={};n.r(i),n.d(i,"hasBrowserEnv",(function(){return Z})),n.d(i,"hasStandardBrowserWebWorkerEnv",(function(){return et})),n.d(i,"hasStandardBrowserEnv",(function(){return tt}));var o=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"v-knowledge-single"},[e("notice"),t.data&&t.data.post?e("div",{staticClass:"m-wiki"},[e("WikiPanel",{staticClass:"m-knowledge-panel",attrs:{"wiki-post":t.data}},[e("template",{slot:"head-title"},[e("svg",{class:"u-icon",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 412.72 412.72","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[e("path",{attrs:{d:"M404.72 82.944h-27.2v-9.28a8 8 0 00-5.76-8 225.345 225.345 0 00-57.68-7.36c-32 0-75.6 7.2-107.84 40-32-33.12-75.92-40-107.84-40a225.345 225.345 0 00-57.68 7.36 8 8 0 00-5.76 8v9.2H8a8 8 0 00-8 8v255.52a8 8 0 008 8 7.996 7.996 0 003.92-1.04c.8-.4 80.8-44.16 192.48-16h1.92a8.008 8.008 0 001.92 0c112-28.4 192 15.28 192.48 16a8 8 0 0012-6.88V90.944a8 8 0 00-8-8zM16 333.664V98.944h19.12v200.64a8 8 0 009.2 8 350.096 350.096 0 0150-4 207.516 207.516 0 0168.32 10.32A294.1 294.1 0 0016 333.664zm78.32-46a351.994 351.994 0 00-43.52 2.8V79.984a220.645 220.645 0 0147.44-5.28c29.92 0 71.2 6.88 99.84 39.2l.24 199.28c-16.64-10.88-49.12-25.52-104-25.52zm120-173.76c28.64-32 69.92-39.2 99.84-39.2a221.61 221.61 0 0147.44 5.28v210.48a351.895 351.895 0 00-43.28-2.88c-54.56 0-87.12 14.64-104 25.52v-199.2zm182.32 219.76a294.158 294.158 0 00-146.96-19.76 208.008 208.008 0 0168.64-10.32 349.994 349.994 0 0150.32 3.92 8 8 0 009.2-8V98.944h19.12l-.32 234.72z"}})]),e("span",[t._v(t._s(t.title)+" ")])]),e("template",{slot:"head-actions"},[e("a",{staticClass:"el-button el-button--primary",attrs:{href:t.publishLink("knowledge/".concat(t.id))}},[e("i",{staticClass:"el-icon-edit"}),e("span",[t._v(t._s(t.$t("完善百科通识")))])])]),e("template",{slot:"body"},[e("Article",{attrs:{content:t.content}})],1)],2),t.id?e("WikiRevisions",{staticStyle:{"margin-bottom":"35px"},attrs:{type:"knowledge","source-id":t.id}}):t._e(),e("div",{staticClass:"m-wiki-thx-panel"},[e("WikiPanel",[e("template",{slot:"head-title"},[e("i",{staticClass:"el-icon-coin"}),e("span",{staticClass:"u-txt"},[t._v(t._s(t.$t("参与打赏")))])]),e("template",{slot:"body"},[e("Thx",{key:"item-thx-"+t.id,staticClass:"m-thx",attrs:{postId:~~t.id,postType:"knowledge",postTitle:t.title,userId:t.author_id,adminBoxcoinEnable:!0,userBoxcoinEnable:!0,mode:"wiki",authors:t.authors}})],1)],2)],1),t.id?e("WikiPanel",{staticClass:"m-knowledge-panel"},[e("template",{slot:"head-title"},[e("i",{staticClass:"el-icon-chat-line-round"}),e("span",{staticClass:"u-title"},[t._v(t._s(t.$t("讨论")))])]),e("template",{slot:"body"},[e("Comment",{attrs:{id:t.id,category:"knowledge"}})],1)],2):t._e()],1):e("div",{staticClass:"m-wiki-null"},[e("i",{staticClass:"el-icon-s-opportunity"}),e("span",[t._v(t._s(t.$t("暂无内容，我要")))]),e("a",{staticClass:"s-link",attrs:{href:t.publishLink("knowledge/".concat(t.id))}},[t._v(t._s(t.$t("完善百科通识")))])])],1)},r=[],a=(n("4de4"),n("d81d"),n("14d9"),n("b0c0"),n("d3b7"),n("9616")),s=n("85e4"),c=n("d2a1"),l=n("a579"),u=n("c9d2"),d=n("500d"),m=n("a974"),p=function(){var t=this,e=t._self._c;return e("el-container",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"c-comment"},[e("el-main",[e("CommentInputForm",{on:{submit:t.userSubmitInputForm}}),e("div",{staticClass:"c-comment-panel"},[e("div",{staticClass:"u-order"},[e("span",{staticClass:"u-label"},[t._v(t._s(t.$t("排序模式：")))]),e("el-radio-group",{attrs:{size:"mini"},on:{change:t.changeOrder},model:{value:t.isDesc,callback:function(e){t.isDesc=e},expression:"isDesc"}},[e("el-radio-button",{attrs:{label:"DESC"}},[t._v(t._s(t.$t("最后靠前")))]),e("el-radio-button",{attrs:{label:"ASC"}},[t._v(t._s(t.$t("最早靠前")))])],1)],1),e("div",{staticClass:"u-op"},[e("el-switch",{staticClass:"c-comment-panel-likes",attrs:{"active-text":t.$t("获赞靠前")},on:{change:t.changeOrderByLikes},model:{value:t.orderByLikes,callback:function(e){t.orderByLikes=e},expression:"orderByLikes"}}),t.commentPower.is_author||t.commentPower.is_editor?e("el-switch",{staticClass:"c-comment-panel-likes",attrs:{"active-text":t.$t("开启过滤"),title:t.$t("开启过滤后，仅设为显示的评论可被其他人所见")},on:{change:t.changeWhiteList},model:{value:t.openWhiteList,callback:function(e){t.openWhiteList=e},expression:"openWhiteList"}}):t._e()],1)]),t.isNormal?[t._l(t.commentList,(function(n){return e("div",{key:n.id,staticClass:"c-comment-list"},[e("CommentAvatar",{attrs:{"user-avatar":t._f("showAvatar")(n.avatar),"user-href":t._f("profileLink")(n.userId),username:n.displayName,avatarFrame:n.user_avatar_frame,withFrame:!0,avatarSize:48}}),e("CommentAndReply",{attrs:{"base-api":t.baseAPI,item:n,category:t.category,power:t.commentPower,"user-href":t._f("profileLink")(n.userId),username:n.displayName},on:{deleteComment:t.deleteComment,setTopComment:t.setTopComment,setStarComment:t.setStarComment,setWhiteComment:t.setWhiteComment,setLikeComment:t.setLikeComment,hide:t.hideComment}})],1)})),e("div",{staticClass:"c-comment-pages"},[t.commentList.length>5?e("CommentInputForm",{attrs:{isBottom:t.commentList.length>5},on:{submit:t.userSubmitInputForm}}):t._e(),e("div",{staticClass:"u-pages"},[e("el-pagination",{staticStyle:{"text-align":"right"},attrs:{background:"","hide-on-single-page":"","current-page":t.pager.index,"page-size":t.pager.pageSize,layout:"prev, pager, next, total",total:t.pager.total},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){return t.$set(t.pager,"index",e)},"update:current-page":function(e){return t.$set(t.pager,"index",e)}}})],1)],1)]:t._e()],2)],1)},h=[],f=(n("99af"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"c-comment-avatar"},[e("a",{staticClass:"u-avatar",attrs:{href:t.userHref,target:"_blank"}},[e("el-avatar",{staticClass:"u-avatar-pic",attrs:{shape:"circle",size:t.avatarSize,src:t.userAvatar}}),t.avatarFrame?e("i",{staticClass:"u-avatar-frame",class:36==t.avatarSize?"xxs":"xs"},[e("img",{attrs:{src:t.frameUrl}})]):t._e()],1),e("el-link",{staticClass:"u-name",attrs:{type:"primary",target:"_blank",href:t.userHref}},[t._v(t._s(t.username))])],1)}),g=[],y=n("65c2"),b={props:["avatarSize","userAvatar","userHref","username","avatarFrame","withFrame"],data:function(){return{}},computed:{frameUrl:function(){return y["__imgPath"]+"avatar/images/".concat(this.avatarFrame,"/").concat(this.avatarFrame,".svg")}},methods:{},mounted:function(){}},v=b,w=(n("18aa"),n("2877")),C=Object(w["a"])(v,f,g,!1,null,null,null),_=C.exports,k=function(){var t=this,e=t._self._c;return e("el-form",{ref:"form",staticClass:"c-comment-box",attrs:{model:t.newComment}},[e("el-form-item",[e("el-input",{attrs:{rows:"3",type:"textarea",maxlength:t.maxLength,"show-word-limit":"",placeholder:"参与讨论...",id:t.inputId},model:{value:t.newComment.content,callback:function(e){t.$set(t.newComment,"content",e)},expression:"newComment.content"}}),e("div",{staticClass:"c-comment-tools"},[e("i",{staticClass:"el-icon-picture-outline u-upload-icon",on:{click:function(e){t.showUploader=!t.showUploader}}}),e("Emotion",{staticClass:"c-comment-emotion",attrs:{type:"pop",max:6},on:{selected:t.handleEmotionSelected}}),e("quickReply",{on:{reply:t.onQuickReply}}),e("div",{staticClass:"c-comment-secret"},[e("el-checkbox",{staticClass:"u-secret",attrs:{border:"",size:"mini"},model:{value:t.is_secret,callback:function(e){t.is_secret=e},expression:"is_secret"}},[t._v("悄悄话 "),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.$t("勾选悄悄话后仅作者和你可见，并且不可再变更状态"),placement:"top"}},[e("i",{staticClass:"el-icon-info"})])],1)],1)],1),t.showUploader?e("Uploader",{ref:"uploader",staticClass:"u-uploader",on:{onFinish:t.attachmentUploadFinish,onError:t.attachmentUplodError}}):t._e(),e("div",{staticClass:"u-toolbar"},[e("el-button",{staticClass:"u-publish",attrs:{type:"primary",disabled:t.disableSubmitBtn},on:{click:t.onSubmit}},[t._v(t._s(t.$t("发表评论")))])],1)],1)],1)},x=[],S=n("c7eb"),O=n("1da1"),E=(n("a15b"),n("13d5"),function(){var t=this,e=t._self._c;return e("div",[e("el-upload",{ref:"upload",attrs:{action:"https://cms.jx3box.com/api/cms/upload","list-type":"picture-card","on-preview":t.handlePictureCardPreview,"auto-upload":!1,"file-list":t.fileList,limit:t.maxCount,accept:t.acceptedExtensions.reduce((function(t,e){return t+".".concat(e,",")}),""),multiple:"","with-credentials":"","on-exceed":t.onExceed,"on-change":t.onChange,"on-success":t.onSuccess,"on-error":t.onError}},[e("i",{staticClass:"el-icon-plus"}),e("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v(" 最多上传 "+t._s(t.maxCount)+" 张 "+t._s(t.acceptedExtensions.join(" / ").toUpperCase())+" 格式图片，单张图片不能超过 "+t._s(t.maxSize/1024/1024)+" MB ")])]),e("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("img",{attrs:{width:"60%",src:t.dialogImageUrl,alt:""}})])],1)}),L=[],R={data:function(){return{dialogImageUrl:"",dialogVisible:!1,fileList:[],successList:[],acceptedExtensions:["jpg","jpeg","png","gif"],maxCount:5,maxSize:2097152}},methods:{handlePictureCardPreview:function(t){this.dialogImageUrl=t.url,this.dialogVisible=!0},onExceed:function(){this.$notify({title:"",message:"最多上传 ".concat(this.maxCount," 张图片！"),type:"error",duration:3e3,position:"bottom-right"})},onChange:function(t,e){"ready"==t.status&&(t.size>this.maxSize?(this.$notify({title:"",message:"单张图片大小不能超过 ".concat(this.maxSize/1024/1024," MB！"),type:"error",duration:3e3,position:"bottom-right"}),e.pop()):this.fileList=e)},upload:function(){this.fileList.length>0?this.$refs.upload.submit():this.$emit("onFinish",[])},onSuccess:function(t){this.successList=this.successList.concat(t.data),this.successList.length==this.fileList.length&&(this.$emit("onFinish",this.successList||[]),this.fileList=[],this.successList=[])},onError:function(){this.$notify({title:"",message:"图片上传失败!",type:"error",duration:3e3,position:"bottom-right"}),this.$emit("onError"),this.fileList=[]}}},j=R,A=Object(w["a"])(j,E,L,!1,null,null,null),T=A.exports,P=function(){var t=this,e=t._self._c;return e("div",{staticClass:"c-jx3box-emotion"},["default"===t.type?e("el-tabs",{attrs:{type:"card"}},t._l(t.decorationEmotion,(function(n){return e("el-tab-pane",{key:n.group_id,attrs:{label:n.group_name}},t._l(n.items,(function(n){return e("span",{key:n.emotion_id,staticClass:"c-jx3box-emotion-item",on:{click:function(e){return t.handleEmotionClick(n)}}},[e("img",{attrs:{src:"".concat(t.EmojiPath).concat(n.filename),alt:n.key,title:n.key}})])})),0)})),1):e("el-popover",{ref:"emotion",attrs:{placement:"top",trigger:"click","visible-arrow":!1,"popper-class":"c-jx3box-emotion-pop"}},[e("div",{staticClass:"c-jx3box-emotion-pop__content"},[e("i",{staticClass:"el-icon-close u-close",on:{click:t.closePop}}),e("div",{staticClass:"u-title"},[t._v(t._s(t.$t("表情")))]),e("el-tabs",{staticClass:"u-tabs",attrs:{type:"card","tab-position":"bottom",size:"small"}},t._l(t.decorationEmotion,(function(n){return e("el-tab-pane",{key:n.group_id,attrs:{label:n.group_name},scopedSlots:t._u([{key:"label",fn:function(){return[e("img",{staticClass:"u-tab-label",attrs:{src:"".concat(t.EmojiPath).concat(n.items[0].filename),alt:n.items[0].key,title:n.group_name}})]},proxy:!0}],null,!0)},[e("div",{staticClass:"c-jx3box-emotion-list"},t._l(n.items,(function(n){return e("span",{key:n.emotion_id,staticClass:"c-jx3box-emotion-item",on:{click:function(e){return t.handleEmotionClick(n)}}},[e("img",{attrs:{src:"".concat(t.EmojiPath).concat(n.filename),alt:n.key,title:n.key}})])})),0)])})),1)],1),e("img",{staticClass:"u-reference",attrs:{slot:"reference",width:"24",height:"24",src:n("220a"),alt:""},slot:"reference"})])],1)},F=[],$=n("2909"),U=(n("caad"),n("fb6a"),n("e9c4"),n("a9e3"),n("b64b"),n("2532"),n("3f99")),I=n("1cbd"),N=n("d790");function B(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,(function(t){return e[t]}))}function D(t,e){this._pairs=[],t&&Object(N["a"])(t,this,e)}const z=D.prototype;z.append=function(t,e){this._pairs.push([t,e])},z.toString=function(t){const e=t?function(e){return t.call(this,e,B)}:B;return this._pairs.map((function(t){return e(t[0])+"="+e(t[1])}),"").join("&")};var H=D;function W(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function q(t,e,n){if(!e)return t;const i=n&&n.encode||W,o=n&&n.serialize;let r;if(r=o?o(e,n):U["a"].isURLSearchParams(e)?e.toString():new H(e,n).toString(i),r){const e=t.indexOf("#");-1!==e&&(t=t.slice(0,e)),t+=(-1===t.indexOf("?")?"?":"&")+r}return t}class M{constructor(){this.handlers=[]}use(t,e,n){return this.handlers.push({fulfilled:t,rejected:e,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){U["a"].forEach(this.handlers,(function(e){null!==e&&t(e)}))}}var J=M,V=n("dc93"),K={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},G="undefined"!==typeof URLSearchParams?URLSearchParams:H,X="undefined"!==typeof FormData?FormData:null,Q="undefined"!==typeof Blob?Blob:null,Y={isBrowser:!0,classes:{URLSearchParams:G,FormData:X,Blob:Q},protocols:["http","https","file","blob","url","data"]};const Z="undefined"!==typeof window&&"undefined"!==typeof document,tt=(t=>Z&&["ReactNative","NativeScript","NS"].indexOf(t)<0)("undefined"!==typeof navigator&&navigator.product),et=(()=>"undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"===typeof self.importScripts)();var nt={...i,...Y};function it(t,e){return Object(N["a"])(t,new nt.classes.URLSearchParams,Object.assign({visitor:function(t,e,n,i){return nt.isNode&&U["a"].isBuffer(t)?(this.append(e,t.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},e))}function ot(t){return U["a"].matchAll(/\w+|\[(\w*)]/g,t).map(t=>"[]"===t[0]?"":t[1]||t[0])}function rt(t){const e={},n=Object.keys(t);let i;const o=n.length;let r;for(i=0;i<o;i++)r=n[i],e[r]=t[r];return e}function at(t){function e(t,n,i,o){let r=t[o++];if("__proto__"===r)return!0;const a=Number.isFinite(+r),s=o>=t.length;if(r=!r&&U["a"].isArray(i)?i.length:r,s)return U["a"].hasOwnProp(i,r)?i[r]=[i[r],n]:i[r]=n,!a;i[r]&&U["a"].isObject(i[r])||(i[r]=[]);const c=e(t,n,i[r],o);return c&&U["a"].isArray(i[r])&&(i[r]=rt(i[r])),!a}if(U["a"].isFormData(t)&&U["a"].isFunction(t.entries)){const n={};return U["a"].forEachEntry(t,(t,i)=>{e(ot(t),i,n,0)}),n}return null}var st=at;function ct(t,e,n){if(U["a"].isString(t))try{return(e||JSON.parse)(t),U["a"].trim(t)}catch(i){if("SyntaxError"!==i.name)throw i}return(n||JSON.stringify)(t)}const lt={transitional:K,adapter:["xhr","http"],transformRequest:[function(t,e){const n=e.getContentType()||"",i=n.indexOf("application/json")>-1,o=U["a"].isObject(t);o&&U["a"].isHTMLForm(t)&&(t=new FormData(t));const r=U["a"].isFormData(t);if(r)return i?JSON.stringify(st(t)):t;if(U["a"].isArrayBuffer(t)||U["a"].isBuffer(t)||U["a"].isStream(t)||U["a"].isFile(t)||U["a"].isBlob(t))return t;if(U["a"].isArrayBufferView(t))return t.buffer;if(U["a"].isURLSearchParams(t))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let a;if(o){if(n.indexOf("application/x-www-form-urlencoded")>-1)return it(t,this.formSerializer).toString();if((a=U["a"].isFileList(t))||n.indexOf("multipart/form-data")>-1){const e=this.env&&this.env.FormData;return Object(N["a"])(a?{"files[]":t}:t,e&&new e,this.formSerializer)}}return o||i?(e.setContentType("application/json",!1),ct(t)):t}],transformResponse:[function(t){const e=this.transitional||lt.transitional,n=e&&e.forcedJSONParsing,i="json"===this.responseType;if(t&&U["a"].isString(t)&&(n&&!this.responseType||i)){const n=e&&e.silentJSONParsing,r=!n&&i;try{return JSON.parse(t)}catch(o){if(r){if("SyntaxError"===o.name)throw V["a"].from(o,V["a"].ERR_BAD_RESPONSE,this,null,this.response);throw o}}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:nt.classes.FormData,Blob:nt.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};U["a"].forEach(["delete","get","head","post","put","patch"],t=>{lt.headers[t]={}});var ut=lt;const dt=U["a"].toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]);var mt=t=>{const e={};let n,i,o;return t&&t.split("\n").forEach((function(t){o=t.indexOf(":"),n=t.substring(0,o).trim().toLowerCase(),i=t.substring(o+1).trim(),!n||e[n]&&dt[n]||("set-cookie"===n?e[n]?e[n].push(i):e[n]=[i]:e[n]=e[n]?e[n]+", "+i:i)})),e};const pt=Symbol("internals");function ht(t){return t&&String(t).trim().toLowerCase()}function ft(t){return!1===t||null==t?t:U["a"].isArray(t)?t.map(ft):String(t)}function gt(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;while(i=n.exec(t))e[i[1]]=i[2];return e}const yt=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function bt(t,e,n,i,o){return U["a"].isFunction(i)?i.call(this,e,n):(o&&(e=n),U["a"].isString(e)?U["a"].isString(i)?-1!==e.indexOf(i):U["a"].isRegExp(i)?i.test(e):void 0:void 0)}function vt(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,e,n)=>e.toUpperCase()+n)}function wt(t,e){const n=U["a"].toCamelCase(" "+e);["get","set","has"].forEach(i=>{Object.defineProperty(t,i+n,{value:function(t,n,o){return this[i].call(this,e,t,n,o)},configurable:!0})})}class Ct{constructor(t){t&&this.set(t)}set(t,e,n){const i=this;function o(t,e,n){const o=ht(e);if(!o)throw new Error("header name must be a non-empty string");const r=U["a"].findKey(i,o);(!r||void 0===i[r]||!0===n||void 0===n&&!1!==i[r])&&(i[r||e]=ft(t))}const r=(t,e)=>U["a"].forEach(t,(t,n)=>o(t,n,e));return U["a"].isPlainObject(t)||t instanceof this.constructor?r(t,e):U["a"].isString(t)&&(t=t.trim())&&!yt(t)?r(mt(t),e):null!=t&&o(e,t,n),this}get(t,e){if(t=ht(t),t){const n=U["a"].findKey(this,t);if(n){const t=this[n];if(!e)return t;if(!0===e)return gt(t);if(U["a"].isFunction(e))return e.call(this,t,n);if(U["a"].isRegExp(e))return e.exec(t);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,e){if(t=ht(t),t){const n=U["a"].findKey(this,t);return!(!n||void 0===this[n]||e&&!bt(this,this[n],n,e))}return!1}delete(t,e){const n=this;let i=!1;function o(t){if(t=ht(t),t){const o=U["a"].findKey(n,t);!o||e&&!bt(n,n[o],o,e)||(delete n[o],i=!0)}}return U["a"].isArray(t)?t.forEach(o):o(t),i}clear(t){const e=Object.keys(this);let n=e.length,i=!1;while(n--){const o=e[n];t&&!bt(this,this[o],o,t,!0)||(delete this[o],i=!0)}return i}normalize(t){const e=this,n={};return U["a"].forEach(this,(i,o)=>{const r=U["a"].findKey(n,o);if(r)return e[r]=ft(i),void delete e[o];const a=t?vt(o):String(o).trim();a!==o&&delete e[o],e[a]=ft(i),n[a]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const e=Object.create(null);return U["a"].forEach(this,(n,i)=>{null!=n&&!1!==n&&(e[i]=t&&U["a"].isArray(n)?n.join(", "):n)}),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,e])=>t+": "+e).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...e){const n=new this(t);return e.forEach(t=>n.set(t)),n}static accessor(t){const e=this[pt]=this[pt]={accessors:{}},n=e.accessors,i=this.prototype;function o(t){const e=ht(t);n[e]||(wt(i,t),n[e]=!0)}return U["a"].isArray(t)?t.forEach(o):o(t),this}}Ct.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),U["a"].reduceDescriptors(Ct.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(t){this[n]=t}}}),U["a"].freezeMethods(Ct);var _t=Ct;function kt(t,e){const n=this||ut,i=e||n,o=_t.from(i.headers);let r=i.data;return U["a"].forEach(t,(function(t){r=t.call(n,r,o.normalize(),e?e.status:void 0)})),o.normalize(),r}function xt(t){return!(!t||!t.__CANCEL__)}function St(t,e,n){V["a"].call(this,null==t?"canceled":t,V["a"].ERR_CANCELED,e,n),this.name="CanceledError"}U["a"].inherits(St,V["a"],{__CANCEL__:!0});var Ot=St,Et=n("34ea");function Lt(t,e,n){const i=n.config.validateStatus;n.status&&i&&!i(n.status)?e(new V["a"]("Request failed with status code "+n.status,[V["a"].ERR_BAD_REQUEST,V["a"].ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):t(n)}var Rt=nt.hasStandardBrowserEnv?{write(t,e,n,i,o,r){const a=[t+"="+encodeURIComponent(e)];U["a"].isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),U["a"].isString(i)&&a.push("path="+i),U["a"].isString(o)&&a.push("domain="+o),!0===r&&a.push("secure"),document.cookie=a.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function jt(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function At(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function Tt(t,e){return t&&!jt(e)?At(t,e):e}var Pt=nt.hasStandardBrowserEnv?function(){const t=/(msie|trident)/i.test(navigator.userAgent),e=document.createElement("a");let n;function i(n){let i=n;return t&&(e.setAttribute("href",i),i=e.href),e.setAttribute("href",i),{href:e.href,protocol:e.protocol?e.protocol.replace(/:$/,""):"",host:e.host,search:e.search?e.search.replace(/^\?/,""):"",hash:e.hash?e.hash.replace(/^#/,""):"",hostname:e.hostname,port:e.port,pathname:"/"===e.pathname.charAt(0)?e.pathname:"/"+e.pathname}}return n=i(window.location.href),function(t){const e=U["a"].isString(t)?i(t):t;return e.protocol===n.protocol&&e.host===n.host}}():function(){return function(){return!0}}();function Ft(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function $t(t,e){t=t||10;const n=new Array(t),i=new Array(t);let o,r=0,a=0;return e=void 0!==e?e:1e3,function(s){const c=Date.now(),l=i[a];o||(o=c),n[r]=s,i[r]=c;let u=a,d=0;while(u!==r)d+=n[u++],u%=t;if(r=(r+1)%t,r===a&&(a=(a+1)%t),c-o<e)return;const m=l&&c-l;return m?Math.round(1e3*d/m):void 0}}var Ut=$t;function It(t,e){let n=0;const i=Ut(50,250);return o=>{const r=o.loaded,a=o.lengthComputable?o.total:void 0,s=r-n,c=i(s),l=r<=a;n=r;const u={loaded:r,total:a,progress:a?r/a:void 0,bytes:s,rate:c||void 0,estimated:c&&a&&l?(a-r)/c:void 0,event:o};u[e?"download":"upload"]=!0,t(u)}}const Nt="undefined"!==typeof XMLHttpRequest;var Bt=Nt&&function(t){return new Promise((function(e,n){let i=t.data;const o=_t.from(t.headers).normalize();let r,a,{responseType:s,withXSRFToken:c}=t;function l(){t.cancelToken&&t.cancelToken.unsubscribe(r),t.signal&&t.signal.removeEventListener("abort",r)}if(U["a"].isFormData(i))if(nt.hasStandardBrowserEnv||nt.hasStandardBrowserWebWorkerEnv)o.setContentType(!1);else if(!1!==(a=o.getContentType())){const[t,...e]=a?a.split(";").map(t=>t.trim()).filter(Boolean):[];o.setContentType([t||"multipart/form-data",...e].join("; "))}let u=new XMLHttpRequest;if(t.auth){const e=t.auth.username||"",n=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";o.set("Authorization","Basic "+btoa(e+":"+n))}const d=Tt(t.baseURL,t.url);function m(){if(!u)return;const i=_t.from("getAllResponseHeaders"in u&&u.getAllResponseHeaders()),o=s&&"text"!==s&&"json"!==s?u.response:u.responseText,r={data:o,status:u.status,statusText:u.statusText,headers:i,config:t,request:u};Lt((function(t){e(t),l()}),(function(t){n(t),l()}),r),u=null}if(u.open(t.method.toUpperCase(),q(d,t.params,t.paramsSerializer),!0),u.timeout=t.timeout,"onloadend"in u?u.onloadend=m:u.onreadystatechange=function(){u&&4===u.readyState&&(0!==u.status||u.responseURL&&0===u.responseURL.indexOf("file:"))&&setTimeout(m)},u.onabort=function(){u&&(n(new V["a"]("Request aborted",V["a"].ECONNABORTED,t,u)),u=null)},u.onerror=function(){n(new V["a"]("Network Error",V["a"].ERR_NETWORK,t,u)),u=null},u.ontimeout=function(){let e=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded";const i=t.transitional||K;t.timeoutErrorMessage&&(e=t.timeoutErrorMessage),n(new V["a"](e,i.clarifyTimeoutError?V["a"].ETIMEDOUT:V["a"].ECONNABORTED,t,u)),u=null},nt.hasStandardBrowserEnv&&(c&&U["a"].isFunction(c)&&(c=c(t)),c||!1!==c&&Pt(d))){const e=t.xsrfHeaderName&&t.xsrfCookieName&&Rt.read(t.xsrfCookieName);e&&o.set(t.xsrfHeaderName,e)}void 0===i&&o.setContentType(null),"setRequestHeader"in u&&U["a"].forEach(o.toJSON(),(function(t,e){u.setRequestHeader(e,t)})),U["a"].isUndefined(t.withCredentials)||(u.withCredentials=!!t.withCredentials),s&&"json"!==s&&(u.responseType=t.responseType),"function"===typeof t.onDownloadProgress&&u.addEventListener("progress",It(t.onDownloadProgress,!0)),"function"===typeof t.onUploadProgress&&u.upload&&u.upload.addEventListener("progress",It(t.onUploadProgress)),(t.cancelToken||t.signal)&&(r=e=>{u&&(n(!e||e.type?new Ot(null,t,u):e),u.abort(),u=null)},t.cancelToken&&t.cancelToken.subscribe(r),t.signal&&(t.signal.aborted?r():t.signal.addEventListener("abort",r)));const p=Ft(d);p&&-1===nt.protocols.indexOf(p)?n(new V["a"]("Unsupported protocol "+p+":",V["a"].ERR_BAD_REQUEST,t)):u.send(i||null)}))};const Dt={http:Et["a"],xhr:Bt};U["a"].forEach(Dt,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch(n){}Object.defineProperty(t,"adapterName",{value:e})}});const zt=t=>"- "+t,Ht=t=>U["a"].isFunction(t)||null===t||!1===t;var Wt={getAdapter:t=>{t=U["a"].isArray(t)?t:[t];const{length:e}=t;let n,i;const o={};for(let r=0;r<e;r++){let e;if(n=t[r],i=n,!Ht(n)&&(i=Dt[(e=String(n)).toLowerCase()],void 0===i))throw new V["a"](`Unknown adapter '${e}'`);if(i)break;o[e||"#"+r]=i}if(!i){const t=Object.entries(o).map(([t,e])=>`adapter ${t} `+(!1===e?"is not supported by the environment":"is not available in the build"));let n=e?t.length>1?"since :\n"+t.map(zt).join("\n"):" "+zt(t[0]):"as no adapter specified";throw new V["a"]("There is no suitable adapter to dispatch the request "+n,"ERR_NOT_SUPPORT")}return i},adapters:Dt};function qt(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Ot(null,t)}function Mt(t){qt(t),t.headers=_t.from(t.headers),t.data=kt.call(t,t.transformRequest),-1!==["post","put","patch"].indexOf(t.method)&&t.headers.setContentType("application/x-www-form-urlencoded",!1);const e=Wt.getAdapter(t.adapter||ut.adapter);return e(t).then((function(e){return qt(t),e.data=kt.call(t,t.transformResponse,e),e.headers=_t.from(e.headers),e}),(function(e){return xt(e)||(qt(t),e&&e.response&&(e.response.data=kt.call(t,t.transformResponse,e.response),e.response.headers=_t.from(e.response.headers))),Promise.reject(e)}))}const Jt=t=>t instanceof _t?t.toJSON():t;function Vt(t,e){e=e||{};const n={};function i(t,e,n){return U["a"].isPlainObject(t)&&U["a"].isPlainObject(e)?U["a"].merge.call({caseless:n},t,e):U["a"].isPlainObject(e)?U["a"].merge({},e):U["a"].isArray(e)?e.slice():e}function o(t,e,n){return U["a"].isUndefined(e)?U["a"].isUndefined(t)?void 0:i(void 0,t,n):i(t,e,n)}function r(t,e){if(!U["a"].isUndefined(e))return i(void 0,e)}function a(t,e){return U["a"].isUndefined(e)?U["a"].isUndefined(t)?void 0:i(void 0,t):i(void 0,e)}function s(n,o,r){return r in e?i(n,o):r in t?i(void 0,n):void 0}const c={url:r,method:r,data:r,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:s,headers:(t,e)=>o(Jt(t),Jt(e),!0)};return U["a"].forEach(Object.keys(Object.assign({},t,e)),(function(i){const r=c[i]||o,a=r(t[i],e[i],i);U["a"].isUndefined(a)&&r!==s||(n[i]=a)})),n}const Kt="1.6.7",Gt={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{Gt[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}});const Xt={};function Qt(t,e,n){if("object"!==typeof t)throw new V["a"]("options must be an object",V["a"].ERR_BAD_OPTION_VALUE);const i=Object.keys(t);let o=i.length;while(o-- >0){const r=i[o],a=e[r];if(a){const e=t[r],n=void 0===e||a(e,r,t);if(!0!==n)throw new V["a"]("option "+r+" must be "+n,V["a"].ERR_BAD_OPTION_VALUE)}else if(!0!==n)throw new V["a"]("Unknown option "+r,V["a"].ERR_BAD_OPTION)}}Gt.transitional=function(t,e,n){function i(t,e){return"[Axios v"+Kt+"] Transitional option '"+t+"'"+e+(n?". "+n:"")}return(n,o,r)=>{if(!1===t)throw new V["a"](i(o," has been removed"+(e?" in "+e:"")),V["a"].ERR_DEPRECATED);return e&&!Xt[o]&&(Xt[o]=!0,console.warn(i(o," has been deprecated since v"+e+" and will be removed in the near future"))),!t||t(n,o,r)}};var Yt={assertOptions:Qt,validators:Gt};const Zt=Yt.validators;class te{constructor(t){this.defaults=t,this.interceptors={request:new J,response:new J}}async request(t,e){try{return await this._request(t,e)}catch(n){if(n instanceof Error){let t;Error.captureStackTrace?Error.captureStackTrace(t={}):t=new Error;const e=t.stack?t.stack.replace(/^.+\n/,""):"";n.stack?e&&!String(n.stack).endsWith(e.replace(/^.+\n.+\n/,""))&&(n.stack+="\n"+e):n.stack=e}throw n}}_request(t,e){"string"===typeof t?(e=e||{},e.url=t):e=t||{},e=Vt(this.defaults,e);const{transitional:n,paramsSerializer:i,headers:o}=e;void 0!==n&&Yt.assertOptions(n,{silentJSONParsing:Zt.transitional(Zt.boolean),forcedJSONParsing:Zt.transitional(Zt.boolean),clarifyTimeoutError:Zt.transitional(Zt.boolean)},!1),null!=i&&(U["a"].isFunction(i)?e.paramsSerializer={serialize:i}:Yt.assertOptions(i,{encode:Zt.function,serialize:Zt.function},!0)),e.method=(e.method||this.defaults.method||"get").toLowerCase();let r=o&&U["a"].merge(o.common,o[e.method]);o&&U["a"].forEach(["delete","get","head","post","put","patch","common"],t=>{delete o[t]}),e.headers=_t.concat(r,o);const a=[];let s=!0;this.interceptors.request.forEach((function(t){"function"===typeof t.runWhen&&!1===t.runWhen(e)||(s=s&&t.synchronous,a.unshift(t.fulfilled,t.rejected))}));const c=[];let l;this.interceptors.response.forEach((function(t){c.push(t.fulfilled,t.rejected)}));let u,d=0;if(!s){const t=[Mt.bind(this),void 0];t.unshift.apply(t,a),t.push.apply(t,c),u=t.length,l=Promise.resolve(e);while(d<u)l=l.then(t[d++],t[d++]);return l}u=a.length;let m=e;d=0;while(d<u){const t=a[d++],e=a[d++];try{m=t(m)}catch(p){e.call(this,p);break}}try{l=Mt.call(this,m)}catch(p){return Promise.reject(p)}d=0,u=c.length;while(d<u)l=l.then(c[d++],c[d++]);return l}getUri(t){t=Vt(this.defaults,t);const e=Tt(t.baseURL,t.url);return q(e,t.params,t.paramsSerializer)}}U["a"].forEach(["delete","get","head","options"],(function(t){te.prototype[t]=function(e,n){return this.request(Vt(n||{},{method:t,url:e,data:(n||{}).data}))}})),U["a"].forEach(["post","put","patch"],(function(t){function e(e){return function(n,i,o){return this.request(Vt(o||{},{method:t,headers:e?{"Content-Type":"multipart/form-data"}:{},url:n,data:i}))}}te.prototype[t]=e(),te.prototype[t+"Form"]=e(!0)}));var ee=te;class ne{constructor(t){if("function"!==typeof t)throw new TypeError("executor must be a function.");let e;this.promise=new Promise((function(t){e=t}));const n=this;this.promise.then(t=>{if(!n._listeners)return;let e=n._listeners.length;while(e-- >0)n._listeners[e](t);n._listeners=null}),this.promise.then=t=>{let e;const i=new Promise(t=>{n.subscribe(t),e=t}).then(t);return i.cancel=function(){n.unsubscribe(e)},i},t((function(t,i,o){n.reason||(n.reason=new Ot(t,i,o),e(n.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){this.reason?t(this.reason):this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const e=this._listeners.indexOf(t);-1!==e&&this._listeners.splice(e,1)}static source(){let t;const e=new ne((function(e){t=e}));return{token:e,cancel:t}}}var ie=ne;function oe(t){return function(e){return t.apply(null,e)}}function re(t){return U["a"].isObject(t)&&!0===t.isAxiosError}const ae={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(ae).forEach(([t,e])=>{ae[e]=t});var se=ae;function ce(t){const e=new ee(t),n=Object(I["a"])(ee.prototype.request,e);return U["a"].extend(n,ee.prototype,e,{allOwnKeys:!0}),U["a"].extend(n,e,null,{allOwnKeys:!0}),n.create=function(e){return ce(Vt(t,e))},n}const le=ce(ut);le.Axios=ee,le.CanceledError=Ot,le.CancelToken=ie,le.isCancel=xt,le.VERSION=Kt,le.toFormData=N["a"],le.AxiosError=V["a"],le.Cancel=le.CanceledError,le.all=function(t){return Promise.all(t)},le.spread=oe,le.isAxiosError=re,le.mergeConfig=Vt,le.AxiosHeaders=_t,le.formToJSON=t=>st(U["a"].isHTMLForm(t)?new FormData(t):t),le.getAdapter=Wt.getAdapter,le.HttpStatusCode=se,le.default=le;var ue=le;const{__cms:de}=y,me=t=>{const e=t&&t.domain||de;let n={withCredentials:!0,auth:{username:localStorage&&localStorage.getItem("token")||"",password:"cms common request"},baseURL:e,headers:{}};const i=ue.create(n);return i};var pe=y.__imgPath,he=y.__dataPath,fe={name:"Emotion",props:{type:{type:String,default:"default"},max:{type:Number,default:4}},emits:["selected"],data:function(){return{emotionList:[],EmojiPath:pe+"emotion/output/",decoration:[]}},created:function(){this.loadEmotionList(),this.loadDecoration()},computed:{decorationEmotion:function(t){var e=t.emotionList,n=t.decoration,i=e.filter((function(t){return 0===t.group_id}));if(0===n.length)return i;var o=e.filter((function(t){return n.includes(t.group_name)}));return[].concat(Object($["a"])(i),Object($["a"])(o)).slice(0,this.max)}},methods:{handleEmotionClick:function(t){this.$emit("selected",t),this.closePop()},loadEmotionList:function(){var t=this;try{var e=sessionStorage.getItem("jx3_emotion");if(e)return void(this.emotionList=JSON.parse(e));fetch("".concat(he,"emotion/output/catalog.json")).then((function(t){return t.json()})).then((function(e){t.emotionList=e,sessionStorage.setItem("jx3_emotion",JSON.stringify(e))}))}catch(n){fetch("".concat(he,"emotion/output/catalog.json")).then((function(t){return t.json()})).then((function(e){t.emotionList=e,sessionStorage.setItem("jx3_emotion",JSON.stringify(e))}))}},loadDecoration:function(){var t=this;u["a"].isLogin()&&me().get("/api/cms/user/decoration",{params:{type:"emotion",using:1}}).then((function(e){var n,i;t.decoration=null===(n=e.data)||void 0===n||null===(i=n.data)||void 0===i?void 0:i.map((function(t){return null===t||void 0===t?void 0:t.val}))}))},closePop:function(){this.$refs.emotion&&this.$refs.emotion.doClose()}}},ge=fe,ye=(n("1fda"),Object(w["a"])(ge,P,F,!1,null,null,null)),be=ye.exports,ve=function(){var t=this,e=t._self._c;return e("div",{staticClass:"c-jx3box-reply"},[e("el-popover",{ref:"quickReply",attrs:{"visible-arrow":!0,placement:"top",trigger:"click","popper-class":"c-jx3box-reply-pop"}},[e("div",{staticClass:"c-jx3box-reply-pop__content"},[e("i",{staticClass:"el-icon-close u-close",on:{click:t.closePop}}),e("div",{staticClass:"u-title"},[t._v(t._s(t.$t("快捷回复")))]),e("div",{staticClass:"m-reply-list"},t._l(t.replyTemplate,(function(n,i){return e("div",{key:i,staticClass:"m-reply-list__item",on:{click:function(e){return t.reply(n)}}},[t._v(" "+t._s(n)+" ")])})),0)]),e("img",{staticClass:"u-reference",attrs:{slot:"reference",width:"24",height:"24",src:n("819b"),alt:"comment"},slot:"reference"})])],1)},we=[],Ce=n("25c3"),_e={name:"QuickReply",data:function(){return{replyTemplate:Ce}},emits:["reply"],methods:{closePop:function(){this.$refs.quickReply&&this.$refs.quickReply.doClose()},reply:function(t){this.$emit("reply",t),this.closePop()}}},ke=_e,xe=(n("b143"),Object(w["a"])(ke,ve,we,!1,null,null,null)),Se=xe.exports,Oe={name:"CommentInputForm",components:{Uploader:T,Emotion:be,quickReply:Se},props:{isBottom:{type:Boolean,default:!1}},mounted:function(){this.isBottom&&(this.inputId="textarea-bottom")},data:function(){return{maxLength:500,showUploader:!1,disableSubmitBtn:!1,newComment:{content:""},inputId:"textarea-top",is_secret:!1}},methods:{onSubmit:function(){this.disableSubmitBtn=!0,this.$refs.uploader?this.$refs.uploader.upload():this.attachmentUploadFinish([])},onQuickReply:function(t){this.$emit("submit",{content:t,attachmentList:[],is_template:1})},attachmentUploadFinish:function(t){this.$emit("submit",{content:this.newComment.content,is_secret:this.is_secret?1:0,attachmentList:t}),this.newComment={content:""},this.showUploader=!1,this.disableSubmitBtn=!1},attachmentUplodError:function(){this.disableSubmitBtn=!1},handleEmotionSelected:function(t){this.insertVariable(t)},insertVariable:function(t){var e=this;return Object(O["a"])(Object(S["a"])().mark((function n(){var i,o,r,a;return Object(S["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(i=document.querySelector("#".concat(e.inputId)),o=t.key,!i.selectionStart&&0!==i.selectionStart){n.next=12;break}return r=i.selectionStart,a=i.selectionEnd,e.newComment.content=i.value.substring(0,r)+o+i.value.substring(a,i.value.length),n.next=8,e.$nextTick();case 8:i.focus(),i.setSelectionRange(a+o.length,a+o.length),n.next=13;break;case 12:e.newComment.content=o;case 13:case"end":return n.stop()}}),n)})))()}}},Ee=Oe,Le=(n("bc4e"),Object(w["a"])(Ee,k,x,!1,null,null,null)),Re=Le.exports,je=function(){var t=this,e=t._self._c;return e("div",{staticClass:"c-comment-cmt"},[e("div",{staticClass:"c-comment-cmt__author"},[e("el-link",{staticClass:"u-name",attrs:{type:"primary",target:"_blank",href:t.userHref}},[t._v(t._s(t.username||"人字榜800线无名小侠"))]),t.item.is_top?e("span",{staticClass:"u-mark u-top"},[e("i",{staticClass:"el-icon-download"}),t._v(t._s(t.$t("置顶")))]):t._e(),t.item.is_star?e("span",{staticClass:"u-mark u-star"},[e("i",{staticClass:"el-icon-star-off"}),t._v(t._s(t.$t("精华")))]):t._e(),t.item.is_secret?e("span",{staticClass:"u-mark u-secret"},[e("i",{staticClass:"el-icon-cherry"}),t._v(t._s(t.$t("悄悄话")))]):t._e()],1),e("ContentOfCommentAndReply",{attrs:{date:t.item.commentDate,content:t.item.content,"comment-id":t.item.id,attachments:t._f("stringToArray")(t.item.attachments),"can-delete":t.power.can_del||t.power.uid==t.item.userId,"can-set-top":(t.power.is_author||t.power.is_editor)&&!t.item.is_top,"can-cancel-top":(t.power.is_author||t.power.is_editor)&&t.item.is_top,"can-set-star":!t.item.is_star&&(t.power.is_author||t.power.is_editor),"can-cancel-star":t.item.is_star&&(t.power.is_author||t.power.is_editor),"can-add-white":!t.item.is_white&&1==t.power.article_open_white,"can-remove-white":t.item.is_white&&(1==t.power.is_author||1==t.power.is_editor),"can-hide":1==t.power.is_author||1==t.power.is_editor,"is-like":1==t.item.is_likes,likes:~~t.item.likes},on:{addNewReply:t.addNewReply,deleteComment:t.deleteComment,setTopComment:t.setTopComment,setStarComment:t.setStarComment,setLikeComment:t.setLikeComment,setWhiteComment:t.setWhiteComment,hide:t.hideComment}}),e("ReplyList",{attrs:{data:t.replyList,pager:t.pager,power:t.power},on:{addNewReply:t.addNewReply,deleteReply:t.deleteReply,goto:t.gotoReplyListIndex,resetReply:t.resetReply,setLikeComment:t.setLikeReply,hide:t.hideComment}})],1)},Ae=[],Te=function(){var t=this,e=t._self._c;return e("div",{staticClass:"u-cmt"},[""!=t.content?e("div",{staticClass:"u-text",domProps:{innerHTML:t._s(t.renderContent)}}):t._e(),t.attachments.length?e("div",{staticClass:"u-attachements"},t._l(t.attachments,(function(n){return e("el-image",{key:n,attrs:{src:t._f("showAttachment")(n),"preview-src-list":[t.showPreview(n)],lazy:""}})})),1):t._e(),e("div",{staticClass:"u-toolbar u-toolbar--primary"},[e("div",{staticClass:"u-toolbar-left"},[t.currentUserHadLike?t._e():e("el-button",{staticClass:"u-admin",attrs:{type:"text",size:"mini"},on:{click:function(e){return t.doLike(!0)}}},[e("img",{staticClass:"u-up",attrs:{src:n("b716"),alt:""}}),t._v(t._s(t.$t("点赞"))),e("span",{staticClass:"u-like-count"},[t._v(t._s(t.likesFormat(t.hasLikeCount)))])]),t.currentUserHadLike?e("el-button",{staticClass:"u-admin",attrs:{type:"text",size:"mini"},on:{click:function(e){return t.doLike(!1)}}},[e("img",{staticClass:"u-up",attrs:{src:n("e5de"),alt:""}}),t._v(t._s(t.$t("已赞"))),e("span",{staticClass:"u-like-count"},[t._v(t._s(t.likesFormat(t.hasLikeCount)))])]):t._e(),e("el-button",{staticClass:"u-admin",attrs:{type:"text",size:"mini",icon:"el-icon-chat-round"},on:{click:function(e){t.showForm=!t.showForm}}},[t._v(t._s(t.$t("回复")))]),t.canDelete?e("el-button",{staticClass:"u-admin",attrs:{type:"text",icon:"el-icon-delete",size:"mini"},on:{click:function(e){return t.deleteComment()}}},[t._v(t._s(t.$t("删除")))]):t._e(),t.canHide?e("el-button",{staticClass:"u-admin",attrs:{type:"text",size:"mini",icon:"el-icon-delete",title:t.$t("拉入黑洞后，仅评论者自己独自可见")},on:{click:function(e){return t.hideComment()}}},[t._v(t._s(t.$t("黑洞")))]):t._e(),t.canSetTop?e("el-button",{staticClass:"u-admin",attrs:{type:"text",icon:"el-icon-top",size:"mini"},on:{click:function(e){return t.topComment(!0)}}},[t._v(t._s(t.$t("置顶")))]):t._e(),t.canCancelTop?e("el-button",{staticClass:"u-admin",attrs:{type:"text",icon:"el-icon-top",size:"mini"},on:{click:function(e){return t.topComment(!1)}}},[t._v(t._s(t.$t("取消置顶")))]):t._e(),t.canSetStar?e("el-button",{staticClass:"u-admin",attrs:{type:"text",icon:"el-icon-star-off",size:"mini"},on:{click:function(e){return t.starComment(!0)}}},[t._v(t._s(t.$t("加精")))]):t._e(),t.canCancelStar?e("el-button",{staticClass:"u-admin",attrs:{type:"text",icon:"el-icon-star-on",size:"mini"},on:{click:function(e){return t.starComment(!1)}}},[t._v(t._s(t.$t("取消加精")))]):t._e(),e("time",{staticClass:"u-date"},[e("i",{staticClass:"el-icon-time"}),t._v(" "+t._s(t.dataFormat(t.date))+" ")])],1),e("div",{staticClass:"u-toolbar-right"},[t.canAddWhite?e("el-button",{staticClass:"u-admin u-filter",attrs:{type:"text",size:"mini"},on:{click:function(e){return t.setWhiteComment(!0)}}},[e("img",{staticClass:"u-icon-filter",attrs:{src:n("83b85"),alt:t.$t("显示")}}),t._v(" 显示")]):t._e(),t.canRemoveWhite?e("el-button",{staticClass:"u-admin u-filter",attrs:{type:"text",size:"mini"},on:{click:function(e){return t.setWhiteComment(!1)}}},[e("img",{staticClass:"u-icon-filter",attrs:{src:n("55ce"),alt:t.$t("隐藏")}}),t._v(t._s(t.$t("隐藏")))]):t._e()],1)]),t.showForm?e("el-form",{ref:"form",staticClass:"c-comment-subbox",attrs:{model:t.newComment}},[e("el-form-item",[e("el-input",{attrs:{type:"textarea",placeholder:"参与评论...",id:"id"+t.inputId},model:{value:t.newComment.content,callback:function(e){t.$set(t.newComment,"content",e)},expression:"newComment.content"}})],1),e("el-form-item",[e("div",{staticClass:"c-comment-tools"},[e("i",{staticClass:"el-icon-picture-outline u-upload-icon",on:{click:function(e){t.showUploader=!t.showUploader}}}),e("Emotion",{staticClass:"c-comment-emotion",attrs:{type:"pop",max:6},on:{selected:t.handleEmotionSelected}})],1),t.showUploader?e("Uploader",{ref:"uploader",on:{onFinish:t.attachmentUploadFinish,onError:t.attachmentUplodError}}):t._e()],1),e("el-form-item",[e("el-button",{attrs:{size:"mini",type:"primary",disabled:t.disableSubmitBtn},on:{click:function(e){return t.submit()}}},[t._v(t._s(t.$t("提交")))]),e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){t.showForm=!1}}},[t._v(t._s(t.$t("收起")))])],1)],1):t._e()],1)},Pe=[],Fe=n("1157"),$e=n.n(Fe),Ue=n("2ef0");const{__imgPath:Ie,__dataPath:Ne}=y;async function Be(){const t=sessionStorage.getItem("jx3_emotion");if(t)return JSON.parse(t);{const t=await fetch(Ne+"emotion/output/catalog.json").then(t=>t.json());return sessionStorage.setItem("jx3_emotion",JSON.stringify(t)),t}}class De{constructor(t){this._joke=$e.a.trim(t),this.emotionList=[],this.max=0}async loadEmotionList(){const t=await Be();this.emotionList=t}async _renderHTML(){let t=this._joke;if(!t.includes("#"))return t;for(let e=0;e<3;e++){await this.loadEmotionList();const e=Object(Ue["flatMapDeep"])(this.emotionList.map(t=>t.items)),n=e.map(t=>t.key);while(n.some(e=>t.includes(e))){const e=n.findIndex(e=>t.includes(e)),i=n[e].replace("#","$");t=e>-1?t.replace(n[e],i):t}while(n.some(e=>t.includes(""+e.replace("#","$")))){const i=n.findIndex(e=>t.includes(e.replace("#","$"))),o=e.find(t=>t.key===n[i]),r=o?`${Ie}emotion/output/${o.filename}`:"",a=n[i].replace("#","$");t=r?t.replace(a,`<img src="${r}" alt="${n[i]}" title="${n[i]}" />`):t}if(this.emotionList.length)break}return t}}var ze=De;function He(t){return t.replace(/[<>"']/g,(function(t){switch(t){case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&#39;"}}))}async function We(t){const e=new ze(He(t));return await e._renderHTML()}function qe(t){return t>9?t:"0".concat(t)}var Me={props:["content","date","hasReply","canDelete","canSetTop","canCancelTop","canHide","isLike","likes","canSetStar","canCancelStar","attachments","commentId","canAddWhite","canRemoveWhite"],components:{Uploader:T,Emotion:be},data:function(){return{newComment:{content:""},showForm:!1,disableSubmitBtn:!1,showUploader:!1,inputId:"",previewList:[],currentUserHadLike:this.isLike,hasLikeCount:this.likes,renderContent:""}},watch:{content:{handler:function(t){this.formatContent(t)},immediate:!0}},mounted:function(){this.commentId&&(this.inputId=this.commentId)},computed:{_attachments:function(){return this.attachments.map((function(t){return Object(s["resolveImagePath"])(t)}))}},methods:{doLike:function(t){t!==this.currentUserHadLike&&(this.currentUserHadLike=t,this.hasLikeCount=t?this.hasLikeCount+1:this.hasLikeCount-1,this.$emit("setLikeComment",t))},topComment:function(t){this.$emit("setTopComment",t)},starComment:function(t){this.$emit("setStarComment",t)},setWhiteComment:function(t){this.$emit("setWhiteComment",t)},deleteComment:function(){var t=this;this.$confirm("确定删除该评论吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$emit("deleteComment")})).catch((function(){}))},hideComment:function(){var t=this;this.$confirm("确定隐藏该评论吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$emit("hide",t.commentId)})).catch((function(){}))},dataFormat:function(t){var e=new Date(t);return e.getFullYear()+"-"+qe(e.getMonth()+1)+"-"+qe(e.getDate())+" "+qe(e.getHours())+":"+qe(e.getMinutes())+":"+qe(e.getSeconds())},likesFormat:function(t){return t>0?t:""},attachmentUploadFinish:function(t){this.disableSubmitBtn=!1,this.$emit("addNewReply",{content:this.newComment.content,attachmentList:t}),this.showUploader=!1,this.newComment={content:""}},attachmentUplodError:function(){this.disableSubmitBtn=!1},submit:function(){this.disableSubmitBtn=!0,this.$refs.uploader?this.$refs.uploader.upload():this.attachmentUploadFinish([])},hideForm:function(){},formatContent:function(t){var e=this;return Object(O["a"])(Object(S["a"])().mark((function n(){return Object(S["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,We(t);case 2:e.renderContent=n.sent;case 3:case"end":return n.stop()}}),n)})))()},handleEmotionSelected:function(t){var e=this;return Object(O["a"])(Object(S["a"])().mark((function n(){var i,o,r,a;return Object(S["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(i=document.querySelector("#id".concat(e.inputId)),o=t.key,!i.selectionStart&&0!==i.selectionStart){n.next=12;break}return r=i.selectionStart,a=i.selectionEnd,e.newComment.content=i.value.substring(0,r)+o+i.value.substring(a,i.value.length),n.next=8,e.$nextTick();case 8:i.focus(),i.setSelectionRange(a+o.length,a+o.length),n.next=13;break;case 12:e.newComment.content=o;case 13:case"end":return n.stop()}}),n)})))()},showPreview:function(t){return Object(s["resolveImagePath"])(t)}},filters:{showAttachment:function(t){return Object(s["resolveImagePath"])(t)+"?x-oss-process=style/comment_thumb"}}},Je=Me,Ve=(n("d9e8"),Object(w["a"])(Je,Te,Pe,!1,null,null,null)),Ke=Ve.exports,Ge=function(){var t=this,e=t._self._c;return t.data.length?e("div",{staticClass:"c-comment-replylist"},[t._l(t.data,(function(n){return e("reply-item",{key:n.id,staticClass:"c-comment-reply",attrs:{reply:n,power:t.power},on:{deleteReply:t.deleteReply,addReply:t.addReply,setLikeComment:t.setLikeComment,hide:t.hideReply}})})),t.data.length>=3||t.showPager?e("el-row",[e("el-col",{attrs:{span:4}},[e("el-button",{directives:[{name:"show",rawName:"v-show",value:t.showPager,expression:"showPager"}],attrs:{type:"text"},on:{click:function(e){return t.showLess()}}},[t._v(t._s(t.$t("收起")))]),e("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.showPager,expression:"!showPager"}],attrs:{type:"text"},on:{click:function(e){return t.showMore()}}},[t._v(t._s(t.$t("查看更多")))])],1),e("el-col",{staticClass:"c-comment-reply-pages",attrs:{span:20}},[e("el-pagination",{directives:[{name:"show",rawName:"v-show",value:t.showPager,expression:"showPager"}],attrs:{small:"","current-page":t.pager.index,"page-size":t.pager.pageSize,layout:"total, prev, pager, next",total:t.pager.total},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){return t.$set(t.pager,"index",e)},"update:current-page":function(e){return t.$set(t.pager,"index",e)}}})],1)],1):t._e()],2):t._e()},Xe=[],Qe=function(){var t=this,e=t._self._c;return e("el-row",[e("CommentAvatar",{attrs:{"user-avatar":t._f("showAvatar")(t.reply.avatar),"user-href":t._f("profileLink")(t.reply.userId),username:t.reply.displayName,avatarFrame:t.reply.user_avatar_frame,avatarSize:36}}),e("CommentContentSimple",{attrs:{"comment-id":t.reply.id,date:t.reply.commentDate,content:t.reply.content,attachments:t._f("stringToArray")(t.reply.attachments),"can-delete":t.power.can_del||t.power.uid==t.reply.userId,"can-hide":1==t.power.is_author||1==t.power.is_editor,"can-reply":t.power.uid!=t.reply.userId,"user-href":t._f("profileLink")(t.reply.replyForUID),"reply-for-username":t.reply.replyForUsername,"reply-for-user-id":t.reply.replyForUID,"is-like":1==t.reply.is_likes,likes:~~t.reply.likes},on:{delete:t.deleteReply,showReplyInput:function(e){t.showReplyForReplyFrom=!t.showReplyForReplyFrom},setLikeComment:t.setLikeComment,hide:t.hideReply}}),t.showReplyForReplyFrom?e("ReplyForReply",{attrs:{username:t.reply.displayName,"user-href":t._f("profileLink")(t.reply.userId),"current-id":t.reply.id},on:{hideForm:function(e){t.showReplyForReplyFrom=!1},doReply:t.doReply}}):t._e()],1)},Ye=[],Ze=function(){var t=this,e=t._self._c;return e("div",{staticClass:"u-reply"},[e("div",{staticClass:"u-reply-content"},[0!=t.replyForUserId?e("span",{staticClass:"u-reply-label"},[t._v(" "+t._s(t.$t("回复"))+" "),e("el-link",{attrs:{type:"primary",target:"_blank",href:t.userHref}},[t._v("@"+t._s(t.replyForUsername))]),t._v(" : ")],1):t._e(),e("div",{staticClass:"u-reply-text",domProps:{innerHTML:t._s(t.renderContent)}})]),t.attachments.length?e("div",{staticClass:"u-attachements"},t._l(t.attachments,(function(n){return e("el-image",{key:n,attrs:{src:t._f("showAttachment")(n),"preview-src-list":[t.showPreview(n)],lazy:""}})})),1):t._e(),e("div",{staticClass:"u-toolbar"},[t.currentUserHadLike?t._e():e("el-button",{staticClass:"u-admin",attrs:{type:"text",size:"mini"},on:{click:function(e){return t.doLike(!0)}}},[e("img",{staticClass:"u-up",attrs:{src:n("b716"),alt:""}}),t._v(t._s(t.$t("点赞"))),e("span",{staticClass:"u-like-count"},[t._v(t._s(t.likesFormat(t.hasLikeCount)))])]),t.currentUserHadLike?e("el-button",{staticClass:"u-admin",attrs:{type:"text",size:"mini"},on:{click:function(e){return t.doLike(!1)}}},[e("img",{staticClass:"u-up",attrs:{src:n("e5de"),alt:""}}),t._v(t._s(t.$t("已赞"))),e("span",{staticClass:"u-like-count"},[t._v(t._s(t.likesFormat(t.hasLikeCount)))])]):t._e(),t.canReply?e("el-button",{staticClass:"u-admin",attrs:{type:"text",icon:"el-icon-chat-line-round",size:"mini"},on:{click:function(e){return t.showReplyForReplyInput()}}},[t._v(t._s(t.$t("回复")))]):t._e(),t.canDelete?e("el-button",{staticClass:"u-admin",attrs:{type:"text",icon:"el-icon-delete",size:"mini"},on:{click:function(e){return t.deleteComment()}}},[t._v(t._s(t.$t("删除")))]):t._e(),t.canHide?e("el-button",{staticClass:"u-admin",attrs:{type:"text",size:"mini",icon:"el-icon-delete",title:t.$t("拉入黑洞后，仅评论者自己独自可见")},on:{click:function(e){return t.hideComment()}}},[t._v(" "+t._s(t.$t("黑洞")))]):t._e(),e("time",{staticClass:"u-date"},[e("i",{staticClass:"el-icon-time"}),t._v(" "+t._s(t.dataFormat(t.date))+" ")])],1)])},tn=[];function en(t){return t>9?t:"0".concat(t)}var nn={props:["commentId","content","attachments","date","hasReply","canDelete","canHide","canReply","isLike","likes","userHref","replyForUsername","replyForUserId"],data:function(){return{showInput:!1,currentUserHadLike:this.isLike,hasLikeCount:this.likes,renderContent:""}},computed:{_attachments:function(){return this.attachments.map((function(t){return Object(s["resolveImagePath"])(t)}))}},watch:{content:{handler:function(t){this.formatContent(t)},immediate:!0}},filters:{profileLink:function(t){return Object(s["authorLink"])(t)},showAttachment:function(t){return Object(s["resolveImagePath"])(t)+"?x-oss-process=style/comment_thumb"}},methods:{formatContent:function(t){var e=this;return Object(O["a"])(Object(S["a"])().mark((function n(){return Object(S["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,We(t);case 2:e.renderContent=n.sent;case 3:case"end":return n.stop()}}),n)})))()},getPList:function(t){return t.split("\n")},doLike:function(t){t!==this.currentUserHadLike&&(this.currentUserHadLike=t,this.hasLikeCount=t?this.hasLikeCount+1:this.hasLikeCount-1,this.$emit("setLikeComment",t))},deleteComment:function(){var t=this;this.$confirm("确定删除该评论吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$emit("delete",t.commentId)})).catch((function(){}))},hideComment:function(){var t=this;this.$confirm("确定隐藏该评论吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$emit("hide",t.commentId)})).catch((function(){}))},likesFormat:function(t){return t>0?t:""},dataFormat:function(t){var e=new Date(t);return e.getFullYear()+"-"+en(e.getMonth()+1)+"-"+en(e.getDate())+" "+en(e.getHours())+":"+en(e.getMinutes())+":"+en(e.getSeconds())},showReplyForReplyInput:function(){this.$emit("showReplyInput")},previewImg:function(t){this.$hevueImgPreview({multiple:!0,nowImgIndex:t,imgList:this._attachments,controlBar:!1,clickMaskCLose:!0})},showPreview:function(t){return Object(s["resolveImagePath"])(t)}}},on=nn,rn=(n("b5c8"),Object(w["a"])(on,Ze,tn,!1,null,null,null)),an=rn.exports,sn=function(){var t=this,e=t._self._c;return e("el-form",{ref:"form",staticClass:"c-comment-subbox"},[e("div",{staticClass:"u-subbox-label"},[t._v(" 回复 "),e("el-link",{attrs:{type:"primary",target:"_blank",href:t.userHref}},[t._v("＠"+t._s(t.username))]),t._v(" ： ")],1),e("el-form-item",[e("el-input",{attrs:{type:"textarea",id:"id"+t.inputId,placeholder:t.$t("输入回复...")},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1),e("el-form-item",[e("div",{staticClass:"c-comment-tools"},[e("i",{staticClass:"el-icon-picture-outline u-upload-icon",on:{click:function(e){t.showUploader=!t.showUploader}}}),e("Emotion",{staticClass:"c-comment-emotion",attrs:{type:"pop",max:6},on:{selected:t.handleEmotionSelected}})],1),t.showUploader?e("Uploader",{ref:"uploader",on:{onFinish:t.attachmentUploadFinish,onError:t.attachmentUplodError}}):t._e()],1),e("el-form-item",[e("el-button",{attrs:{size:"mini",type:"primary",disabled:t.disableSubmitBtn},on:{click:function(e){return t.submintReply()}}},[t._v(t._s(t.$t("提交")))]),e("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){return t.hideForm()}}},[t._v(t._s(t.$t("收起")))])],1)],1)},cn=[],ln={props:["username","userHref","currentId"],data:function(){return{content:"",showUploader:!1,disableSubmitBtn:!1,inputId:""}},components:{Uploader:T,Emotion:be},mounted:function(){this.currentId&&(this.inputId=this.currentId)},methods:{submintReply:function(){this.disableSubmitBtn=!0,this.$refs.uploader?this.$refs.uploader.upload():this.attachmentUploadFinish([])},hideForm:function(){this.$emit("hideForm")},attachmentUploadFinish:function(t){this.disableSubmitBtn=!1,this.$emit("doReply",{content:this.content,attachmentList:t}),this.content="",this.showUploader=!1},attachmentUplodError:function(){this.disableSubmitBtn=!1},handleEmotionSelected:function(t){var e=this;return Object(O["a"])(Object(S["a"])().mark((function n(){var i,o,r,a;return Object(S["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(i=document.querySelector("#id".concat(e.inputId)),o=t.key,!i.selectionStart&&0!==i.selectionStart){n.next=12;break}return r=i.selectionStart,a=i.selectionEnd,e.content=i.value.substring(0,r)+o+i.value.substring(a,i.value.length),n.next=8,e.$nextTick();case 8:i.focus(),i.setSelectionRange(a+o.length,a+o.length),n.next=13;break;case 12:e.content=o;case 13:case"end":return n.stop()}}),n)})))()}}},un=ln,dn=(n("e43b"),Object(w["a"])(un,sn,cn,!1,null,null,null)),mn=dn.exports,pn={props:["reply","power"],components:{CommentAvatar:_,CommentContentSimple:an,ReplyForReply:mn},backReplyList:[],data:function(){return{showReplyForReplyFrom:!1}},filters:{profileLink:function(t){return Object(s["authorLink"])(t)},stringToArray:function(t){return t?JSON.parse(t):[]},showAvatar:function(t){return Object(s["showAvatar"])(t,84)}},methods:{deleteReply:function(t){this.$emit("deleteReply",t)},hideReply:function(t){this.$emit("hide",t)},setLikeComment:function(t){this.$emit("setLikeComment",this.reply.id,t)},doReply:function(t){t.replyForUID=this.reply.userId,t.replyForCommentId=this.reply.id,this.$emit("addReply",t),this.showReplyForReplyFrom=!1}}},hn=pn,fn=Object(w["a"])(hn,Qe,Ye,!1,null,null,null),gn=fn.exports,yn={props:["data","power","pager"],components:{ReplyItem:gn},data:function(){return{showPager:!1}},filters:{profileLink:function(t){return Object(s["authorLink"])(t)}},methods:{showMore:function(){this.showPager=!0,this.$emit("goto",1)},showLess:function(){this.showPager=!1,this.$emit("resetReply")},handleCurrentChange:function(t){this.$emit("goto",t)},deleteReply:function(t){this.$emit("deleteReply",t)},hideReply:function(t){this.$emit("hide",t)},setLikeComment:function(t,e){this.$emit("setLikeComment",t,e)},addReply:function(t){this.$emit("addNewReply",t)}}},bn=yn,vn=(n("0906"),Object(w["a"])(bn,Ge,Xe,!1,null,null,null)),wn=vn.exports,Cn=n("5c96");const _n=function(t,e){let n={method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}};return En(t,e,n)};var kn={};const xn=function(t,e,n){if(kn[t])if(Date.now()-kn[t].lastest<6e4){if(kn[t].count>=6)return Cn["Notification"].warning({title:"系统",message:"你单身多久了? 动作这么快, 系统处理不过来 ( T_T )",duration:3e3,position:"bottom-right"}),new Promise((t,e)=>{e()});kn[t].count=kn[t].count+1}else Date.now()-kn[t].lastest>6e4&&(kn[t]={lastest:Date.now(),count:0});else kn[t]={lastest:Date.now(),count:0};let i={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)};return En(t,e,i)},Sn=function(t,e,n){let i={method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)};return En(t,e,i)},On=function(t,e){let n={method:"DELETE"};return En(t,e,n)};function En(t,e,n){let i=y["__next"];if("/"==i[i.length-1]&&(i=i.substring(0,i.length-1)),t=i+t,t=t.replace("/api/","/api/next2/"),n.credentials="include",e){let n=[];Object.keys(e).forEach(t=>{n.push(t+"="+e[t])});let i=y["__next"];"/"==i[i.length-1]&&(i=i.substring(0,i.length-1)),t=t+"?"+n.join("&")}return fetch(t,n).then(t=>{switch(t.status){case 200:break;case 401:throw window.location.href=y["__Links"].account.login+"?redirect="+encodeURIComponent(window.location.href),new Error("错误:"+t.statusText);case 403:throw window.location.href=y["__Links"].account.login+"?redirect="+encodeURIComponent(window.location.href),new Error("错误:"+t.statusText);case 423:throw window.location.href=y["__Links"].account.email_verify+"?redirect="+encodeURIComponent(window.location.href),new Error("错误:"+t.statusText);case 406:throw t.text().then(t=>{Cn["Notification"].warning({title:"系统",message:t||"提交内容不合法,请重新提交",duration:3e3,position:"bottom-right"})}),new Error("错误:"+t.statusText);default:throw t.text().then(e=>{Cn["Notification"].error({title:"系统:"+t.statusText,message:e||"系统错误,请稍后重试!",duration:3e3,position:"bottom-right"})}),new Error("错误:"+t.statusText)}let e=t.headers.get("Content-Type");switch(e=e&&e.split(";").shift(),e){case"application/json":return t.json().then(t=>t&&t.code>0&&""!=t.msg?(Cn["Notification"].warning({title:"提示",message:t.code+":"+t.msg,duration:3e3,position:"bottom-right"}),null):t);default:return t.text()}})}var Ln={props:["item","baseApi","power","user-href","username"],components:{ContentOfCommentAndReply:Ke,ReplyList:wn},data:function(){return{replyList:[],pager:{index:1,pageSize:10,pageTotal:1,total:0}}},filters:{stringToArray:function(t){return t?JSON.parse(t):[]}},created:function(){this.replyList=this.item.reply||[]},methods:{deleteComment:function(){this.$emit("deleteComment",this.item.id)},hideComment:function(){this.$emit("hide",this.item.id)},setTopComment:function(t){this.$emit("setTopComment",this.item.id,t)},setStarComment:function(t){this.$emit("setStarComment",this.item.id,t)},setLikeComment:function(t){this.$emit("setLikeComment",this.item.id,t)},setLikeReply:function(t,e){this.$emit("setLikeComment",t,e)},setWhiteComment:function(t){this.$emit("setWhiteComment",this.item.id,t)},addNewReply:function(t){var e=this;xn("".concat(this.baseApi,"/comment/").concat(this.item.id,"/reply"),null,t).then((function(){e.$notify({title:"",message:"评论成功!",type:"success",duration:3e3,position:"bottom-right"}),e.loadReplyList(e.pager.index)})).catch((function(){}))},deleteReply:function(t){var e=this;On("".concat(this.baseApi,"/comment/").concat(t)).then((function(){e.$notify({title:"",message:"删除成功!",type:"success",duration:3e3,position:"bottom-right"}),e.loadReplyList(e.pager.index)})).catch((function(){}))},gotoReplyListIndex:function(t){this.loadReplyList(t,6)},loadReplyList:function(t,e){var n=this;_n("".concat(this.baseApi,"/comment/").concat(this.item.id,"/reply/page/").concat(t,"?pageSize=").concat(e)).then((function(i){1==t&&3==e&&(n.item.reply=i.data||[]),n.replyList=i.data||[],n.pager=i.page})).catch((function(){}))},resetReply:function(){this.loadReplyList(1,3)}}},Rn=Ln,jn=(n("125d"),Object(w["a"])(Rn,je,Ae,!1,null,null,null)),An=jn.exports,Tn=n("41cb");const Pn="cmt_order";async function Fn(){return u["a"].isLogin()?Object(Tn["a"])({mute:!0}).get("/api/cms/user/conf",{params:{key:Pn}}).then(t=>t.data.data):new Promise(t=>{const e=localStorage.getItem(Pn)||"DESC";t(e)})}async function $n(t){return u["a"].isLogin()?Object(Tn["a"])().put("/api/cms/user/conf",{val:t},{params:{key:Pn}}).then(t=>t.data.data):new Promise(e=>{e(localStorage.setItem(Pn,t))})}var Un={name:"Comment",props:["id","category","normal","order"],components:{CommentAvatar:_,CommentAndReply:An,CommentInputForm:Re},data:function(){return{baseAPI:"",commentPower:{allow:!1,uid:-1},commentList:[],pager:{index:1,pageSize:10,pageTotal:1,total:0},isDesc:"DESC",orderByLikes:!1,openWhiteList:!1,loading:!1}},computed:{isNormal:function(){return void 0===this.normal||this.normal}},methods:{changeOrder:function(){this.reloadCommentList(this.pager.index),$n("ASC"===this.isDesc?"DESC":"ASC")},changeOrderByLikes:function(){this.reloadCommentList(this.pager.index)},changeWhiteList:function(){var t=this;Sn("".concat(this.baseAPI,"/meta/white-list/").concat(this.openWhiteList?"open":"close")).then((function(){return t.reloadPower()})).then((function(){t.commentPower.is_white=t.openWhiteList,t.reloadCommentList(t.pager.index)})).catch((function(){}))},setLikeComment:function(t,e){var n=e?"like":"unlike";Sn("".concat(this.baseAPI,"/comment/").concat(t,"/").concat(n)).then((function(){})).catch((function(){}))},setTopComment:function(t,e){var n=this,i=e?"set":"cancel";Sn("".concat(this.baseAPI,"/comment/").concat(t,"/top/").concat(i)).then((function(){n.reloadCommentList(n.pager.index)})).catch((function(){}))},setStarComment:function(t,e){var n=this,i=e?"set":"cancel";Sn("".concat(this.baseAPI,"/comment/").concat(t,"/star/").concat(i)).then((function(){n.reloadCommentList(n.pager.index)})).catch((function(){}))},setWhiteComment:function(t,e){var n=this,i=e?"add":"remove";Sn("".concat(this.baseAPI,"/comment/").concat(t,"/white-list/").concat(i)).then((function(){n.reloadCommentList(n.pager.index)})).catch((function(){}))},deleteComment:function(t){var e=this;On("".concat(this.baseAPI,"/comment/").concat(t)).then((function(){e.$notify({title:"",message:"删除成功!",type:"success",duration:3e3,position:"bottom-right"}),e.reloadCommentList(e.pager.index)})).catch((function(){}))},hideComment:function(t){var e=this;Sn("".concat(this.baseAPI,"/comment/").concat(t,"/hide")).then((function(){e.$notify({title:"",message:"操作成功!",type:"success",duration:3e3,position:"bottom-right"}),e.reloadCommentList(e.pager.index)})).catch((function(){}))},reloadCommentList:function(t){var e=this;this.loading=!0;var n={};"DESC"===this.isDesc&&(n["desc"]=!0),n["orderby_likes"]=this.orderByLikes,_n("".concat(this.baseAPI,"/comment/page/").concat(t),n).then((function(t){e.commentList=t.data||[],e.pager=t.page})).catch((function(){})).finally((function(){e.loading=!1}))},handleCurrentChange:function(t){this.reloadCommentList(t)},userSubmitInputForm:function(t){var e=this;xn("".concat(this.baseAPI,"/comment"),null,t).then((function(t){t&&~~t.code>0?e.$notify({title:"评论失败",message:t.msg||"",type:"error",duration:3e3,position:"bottom-right"}):(e.$notify({title:"",message:"评论成功!",type:"success",duration:3e3,position:"bottom-right"}),1==e.pager.index&&e.reloadCommentList(e.pager.index))})).catch((function(){}))},reloadPower:function(){var t=this;_n("".concat(this.baseAPI,"/i-am-author")).then((function(e){t.commentPower=e,t.openWhiteList=e.is_white})).catch((function(){}))}},filters:{profileLink:function(t){return Object(s["authorLink"])(t)},showAvatar:function(t){return Object(s["showAvatar"])(t,144)}},created:function(){this.baseAPI="/api/comment/".concat(this.category,"/article/").concat(this.id)},mounted:function(){var t=this;Fn().then((function(e){t.isDesc=e})).then((function(){t.reloadPower()})).finally((function(){t.reloadCommentList(1)}))}},In=Un,Nn=(n("a135"),Object(w["a"])(In,p,h,!1,null,null,null)),Bn=Nn.exports,Dn=n("e395"),zn={name:"Detail",data:function(){return{loading:!1,data:""}},components:{Article:m["a"],WikiPanel:c["a"],WikiRevisions:l["a"],Comment:Bn,notice:Dn["a"]},computed:{id:function(){return this.$route.params.source_id},type:function(){var t,e;return null===(t=this.data)||void 0===t||null===(e=t.source)||void 0===e?void 0:e.type},isRevision:function(){return!!this.$route.params.post_id},author_id:function(){var t,e;return~~(null===(t=this.data)||void 0===t||null===(e=t.post)||void 0===e?void 0:e.user_id)},title:function(){var t,e;return null===(t=this.data)||void 0===t||null===(e=t.source)||void 0===e?void 0:e.name},content:function(){var t,e;return null===(t=this.data)||void 0===t||null===(e=t.post)||void 0===e?void 0:e.content},authors:function(){var t,e,n;return this.isRevision?[]:(null===(t=this.data)||void 0===t||null===(e=t.users)||void 0===e||null===(n=e.filter((function(t){return t.id})))||void 0===n?void 0:n.map((function(t){return{user_id:t.id,user_avatar:t.avatar,display_name:t.nickname}})))||[]},isEditor:function(){return u["a"].isEditor()}},methods:{onSearchKey:function(t){this.$router.push({path:"/",query:{search:t}})},getData:function(){var t=this;this.loading=!0,d["a"].get({type:"knowledge",id:this.id}).then((function(e){t.data=e.data.data,t.data.source&&(t.data.source.post=t.data.post)})).finally((function(){t.loading=!1,Object(a["c"])(t.type,t.id)}))},getPostData:function(){var t=this;this.loading=!0,d["a"].getById(this.$route.params.post_id).then((function(e){var n=e.data.data;n.source&&(t.data.source.post=n.post)})).finally((function(){t.loading=!1,Object(a["c"])(t.type,t.id)}))},goBack:function(){var t,e;null!==(t=this.data)&&void 0!==t&&null!==(e=t.source)&&void 0!==e&&e.type?this.$router.push({name:"normal",params:{knowledge_type:this.data.source.type}}):this.$router.push({name:"index"})},publishLink:s["publishLink"]},watch:{"$route.params.post_id":{immediate:!0,handler:function(){this.$route.params.post_id&&this.getPostData()}},id:{immediate:!0,handler:function(){this.id&&this.getData(this.id)}}}},Hn=zn,Wn=(n("f636"),Object(w["a"])(Hn,o,r,!1,null,null,null));e["default"]=Wn.exports}}]);
//# sourceMappingURL=chunk-2d6ec3c3.1c95efc3.js.map