(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e57a3752"],{"0608":function(t){t.exports=JSON.parse('{"#ä¸‹é›¨":"ä¸‹é›¨.gif","#ä¸¥å¯’":"ä¸¥å¯’.gif","#äº²äº²":"äº²äº².gif","#å‚²æ…¢":"å‚²æ…¢.gif","#å†·æ±—":"å†·æ±—.gif","#å‡¶æ¶":"å‡¶æ¶.gif","#åˆ€":"åˆ€.gif","#å‘æ€’":"å‘æ€’.gif","#å£æ°´":"å£æ°´.gif","#å¯æ€œ":"å¯æ€œ.gif","#å":"å.gif","#å“":"å“.gif","#å‘†":"å‘†.gif","#å‘²ç‰™":"å‘²ç‰™.gif","#å’–å•¡":"å’–å•¡.gif","#å”‡":"å”‡.gif","#å–œæ¬¢":"å–œæ¬¢.gif","#å˜´":"å˜´.gif","#å™¢":"å™¢.gif","#å›°":"å›°.gif","#å¤§ç¬‘":"å¤§ç¬‘.gif","#å¤ªé˜³":"å¤ªé˜³.gif","#åªšçœ¼":"åªšçœ¼.gif","#å®³ç¾":"å®³ç¾.gif","#å¯’":"å¯’.gif","#å°´å°¬":"å°´å°¬.gif","#å·®åŠ²":"å·®åŠ².gif","#å·´æŒ":"å·´æŒ.gif","#å¼º":"å¼º.gif","#å¾—æ„":"å¾—æ„.gif","#å¾®ç¬‘":"å¾®ç¬‘.gif","#å¿ƒç¢":"å¿ƒç¢.gif","#ææ…Œ":"ææ…Œ.gif","#æ¶å¿ƒ":"æ¶å¿ƒ.gif","#æ„Ÿå¹å·":"æ„Ÿå¹å·.gif","#æ‰å˜´":"æ‰å˜´.gif","#æ‰“é›·":"æ‰“é›·.gif","#æ‹æ‰‹":"æ‹æ‰‹.gif","#æ¡æ‰‹":"æ¡æ‰‹.gif","#æ’‡å˜´":"æ’‡å˜´.gif","#æ— å¥ˆ":"æ— å¥ˆ.gif","#æ˜":"æ˜.gif","#æ™•":"æ™•.gif","#æœˆäº®":"æœˆäº®.gif","#æ ‡è®°":"æ ‡è®°.gif","#æ¨±æ¡ƒ":"æ¨±æ¡ƒ.gif","#æ¬£å–œ":"æ¬£å–œ.gif","#æ²‰é»˜":"æ²‰é»˜.gif","#æµæ±—":"æµæ±—.gif","#æµæ³ª":"æµæ³ª.gif","#ç¯æ³¡":"ç¯æ³¡.gif","#çƒŸèŠ±":"çƒŸèŠ±.gif","#çˆ±å¿ƒ":"çˆ±å¿ƒ.gif","#ç‹‚æ±—":"ç‹‚æ±—.gif","#ç‹¡çŒ¾":"ç‹¡çŒ¾.gif","#ç‹¡è¯ˆ":"ç‹¡è¯ˆ.gif","#çŒª":"çŒª.gif","#ç«ç‘°":"ç«ç‘°.gif","#ç”Ÿæ°”":"ç”Ÿæ°”.gif","#ç”µè¯":"ç”µè¯.gif","#ç¡":"ç¡.gif","#ç¤¼ç‰©":"ç¤¼ç‰©.gif","#ç¬¨çŒª":"ç¬¨çŒª.gif","#ç¬¬ä¸€å":"ç¬¬ä¸€å.gif","#ç¬¬ä¸‰å":"ç¬¬ä¸‰å.gif","#ç¬¬äºŒå":"ç¬¬äºŒå.gif","#çº¢ç¯":"çº¢ç¯.gif","#ç»¿ç¯":"ç»¿ç¯.gif","#èƒœåˆ©":"èƒœåˆ©.gif","#èˆŒå¤´":"èˆŒå¤´.gif","#è‰²":"è‰².gif","#èŠ±":"èŠ±.gif","#è‹¹æœ":"è‹¹æœ.gif","#è è":"è è.gif","#è’œå¤´":"è’œå¤´.gif","#èœ¡çƒ›":"èœ¡çƒ›.gif","#è¡°":"è¡°.gif","#è¥¿ç“œ":"è¥¿ç“œ.gif","#è®¨åŒ":"è®¨åŒ.gif","#è®¶å¼‚":"è®¶å¼‚.gif","#é„™è§†":"é„™è§†.gif","#é…·":"é…·.gif","#é’±":"é’±.gif","#é”¤å­":"é”¤å­.gif","#é—®å·":"é—®å·.gif","#é˜´é™©":"é˜´é™©.gif","#éš¾è¿‡":"éš¾è¿‡.gif","#é›ªç³•":"é›ªç³•.gif","#é¥®æ–™":"é¥®æ–™.gif","#é¦’å¤´":"é¦’å¤´.gif","#é¦™è•‰":"é¦™è•‰.gif","#éª·é«…":"éª·é«….gif","#é¬¼è„¸":"é¬¼è„¸.gif","#é»„ç¯":"é»„ç¯.gif"}')},"0941":function(t,e,i){"use strict";i("2997")},2997:function(t,e,i){},"33a5":function(t){t.exports=JSON.parse('{"0":"æ±Ÿæ¹–","1":"å¤©ç­–","2":"ä¸‡èŠ±","3":"çº¯é˜³","4":"ä¸ƒç§€","5":"å°‘æ—","6":"è—å‰‘","7":"ä¸å¸®","8":"æ˜æ•™","9":"äº”æ¯’","10":"å”é—¨","18":"è‹äº‘","19":"é•¿æ­Œ","20":"éœ¸åˆ€","21":"è“¬è±","22":"å‡Œé›ª","23":"è¡å¤©","24":"è¯å®—","26":"åˆ€å®—","29":"ä¸‡çµ"}')},3827:function(t,e,i){},4208:function(t,e,i){!function(e,i){t.exports=i()}(0,(function(){"use strict";return function(t,e,i){t=t||{};var n=e.prototype,a={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function o(t,e,i,a){return n.fromToBase(t,e,i,a)}i.en.relativeTime=a,n.fromToBase=function(e,n,o,s,r){for(var c,l,u,d=o.$locale().relativeTime||a,f=t.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],h=f.length,p=0;p<h;p+=1){var g=f[p];g.d&&(c=s?i(e).diff(o,g.d,!0):o.diff(e,g.d,!0));var m=(t.rounding||Math.round)(Math.abs(c));if(u=c>0,m<=g.r||!g.r){m<=1&&p>0&&(g=f[p-1]);var k=d[g.l];r&&(m=r(""+m)),l="string"==typeof k?k.replace("%d",m):k(m,n,g.l,u);break}}if(n)return l;var v=u?d.future:d.past;return"function"==typeof v?v(l):v.replace("%s",l)},n.to=function(t,e){return o(t,e,this,!0)},n.from=function(t,e){return o(t,e,this)};var s=function(t){return t.$u?i.utc():i()};n.toNow=function(t){return this.to(s(this),t)},n.fromNow=function(t){return this.from(s(this),t)}}}))},"458f":function(t,e,i){},6440:function(t,e,i){"use strict";i("458f")},"77e1":function(t,e,i){"use strict";var n=function(){var t=this,e=t._self._c;return e("el-popover",{attrs:{"popper-class":"m-joke-popover",placement:"top",width:"500",offset:-200},model:{value:t.showPop,callback:function(e){t.showPop=e},expression:"showPop"}},[e("Emotion",{staticClass:"m-publish-joke-emotion",on:{selected:t.handleEmotionSelect}}),e("span",{staticClass:"m-publish-joke-button",staticStyle:{cursor:"pointer"},attrs:{slot:"reference",title:"é€‰æ‹©è¡¨æƒ…"},slot:"reference"},[t._v("ğŸ˜€æ’å…¥è¡¨æƒ…")])],1)},a=[],o=i("c840"),s={name:"joke_post",components:{Emotion:o["a"]},data:function(){return{showPop:!1}},methods:{handleEmotionSelect:function(t){this.$emit("emotion",t),this.showPop=!1}}},r=s,c=(i("0941"),i("2877")),l=Object(c["a"])(r,n,a,!1,null,null,null);e["a"]=l.exports},a0b5:function(t,e,i){"use strict";var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-left-tab"},[e("el-tabs",{attrs:{"tab-position":t.windowWidth<=768?"top":"left"},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[e("el-tab-pane",{attrs:{name:"all",label:"å…¨éƒ¨"}},[e("span",{attrs:{slot:"label"},slot:"label"},[e("i",{staticClass:"u-icon el-icon-menu",staticStyle:{"vertical-align":"0"}})])]),t._l(t.schoolmap,(function(i,n){return e("el-tab-pane",{key:n,attrs:{name:n}},[e("div",{attrs:{slot:"label"},slot:"label"},[e("img",{staticClass:"u-icon",attrs:{src:t.showSchoolIcon(n),alt:i,title:i}})])])}))],2)],1)},a=[],o=i("33a5"),s=i("65c2"),r={name:"LeftTab",data:function(){return{type:"all",windowWidth:document.documentElement.clientWidth,schoolmap:o}},watch:{type:function(t){this.$emit("setType",t)}},methods:{showSchoolIcon:function(t){return s["__imgPath"]+"image/school/"+t+".png"}},mounted:function(){var t=this;window.onresize=function(){t.windowWidth=document.documentElement.clientWidth}}},c=r,l=(i("6440"),i("2877")),u=Object(l["a"])(c,n,a,!1,null,null,null);e["a"]=u.exports},af4f:function(t,e,i){"use strict";i("3827")},ecfb:function(t,e,i){"use strict";i.r(e);i("ac1f"),i("841c"),i("498a");var n=function(){var t=this,e=t._self._c;return e("ListLayout",[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"v-joke"},[t.id?e("div",{staticClass:"m-joke-single-container"},[e("div",{staticClass:"m-joke-goback"},[e("el-button",{staticClass:"u-back",attrs:{size:"mini",icon:"el-icon-arrow-left"},on:{click:t.goBack}},[t._v("è¿”å›åˆ—è¡¨")]),e("a",{staticClass:"u-doc",attrs:{href:"/tool/23239",target:"_blank"}},[e("i",{staticClass:"el-icon-info"}),t._v("æ¸¸æˆå†…è·å–æˆ–å‘å¸ƒéªšè¯ ")])],1),e("el-row",{staticClass:"m-joke-list",attrs:{gutter:20}},[e("el-col",{attrs:{span:24}},[e("div",{staticClass:"m-joke-item"},[e("joke-item",{attrs:{joke:t.joke,mode:"single"}})],1)])],1),e("Thx",{staticClass:"m-thx",attrs:{postId:~~t.id,postType:"joke",postTitle:t.title,userId:t.user_id,adminBoxcoinEnable:!0,userBoxcoinEnable:!0,client:"all"}}),e("div",{staticClass:"m-single-comment"},[e("el-divider",{attrs:{"content-position":"left"}},[t._v("è¯„è®º")]),e("Comment",{attrs:{id:t.id,category:"joke"}})],1)],1):e("div",{staticClass:"m-joke-list-container"},[e("div",{staticClass:"m-archive-search m-joke-search",attrs:{slot:"search-before"},slot:"search-before"},[e("el-input",{attrs:{placeholder:"è¯·è¾“å…¥æœç´¢å†…å®¹",clearable:""},on:{clear:t.onSearch},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onSearch.apply(null,arguments)}},model:{value:t.search,callback:function(e){t.search="string"===typeof e?e.trim():e},expression:"search"}},[e("span",{attrs:{slot:"prepend"},slot:"prepend"},[e("i",{staticClass:"el-icon-search"}),t._v(" "),e("span",{staticClass:"u-search"},[t._v("å…³é”®è¯")])]),e("el-switch",{attrs:{slot:"append","inactive-value":0,"active-value":1,"inactive-text":"åªçœ‹ç²¾é€‰"},slot:"append",model:{value:t.star,callback:function(e){t.star=e},expression:"star"}})],1)],1),e("div",{staticClass:"m-joke-main"},[e("left-tab",{staticClass:"m-joke-types",on:{setType:t.setType}}),e("div",{staticClass:"m-joke-content"},[e("joke-post",{attrs:{type:t.type}}),t.jokes&&t.jokes.length?e("div",{staticClass:"m-joke-list",attrs:{gutter:20}},t._l(t.jokes,(function(i){return e("div",{key:i.id,attrs:{span:24}},[e("div",{staticClass:"m-joke-item"},[e("joke-item",{attrs:{joke:i,jokeRewardArr:t.jokeRewardArr},on:{doReward:t.doReward,update:t.handleJokeUpdate}})],1)])})),0):e("el-alert",{attrs:{title:"æ²¡æœ‰æ‰¾åˆ°ç›¸å…³æ¡ç›®",type:"info","show-icon":""}}),e("div",{staticClass:"m-joke-footer"},[e("el-pagination",{staticClass:"m-joke-pagination",attrs:{background:"","page-size":t.per,"hide-on-single-page":!0,"current-page":t.page,layout:"total, prev, pager, next, jumper,sizes",total:t.total,"page-sizes":[10,30,50,70,90]},on:{"update:currentPage":function(e){t.page=e},"update:current-page":function(e){t.page=e},"current-change":t.skipTop,"size-change":t.handleSizeChange}}),t.isEditor?e("div",{staticClass:"m-joke-reward"},[e("el-button",{staticClass:"m-joke-all",attrs:{type:"primary",size:"mini"},on:{click:t.rewardAll}},[t._v(t._s(this.rewardAllType?"å–æ¶ˆ":"")+" å…¨é€‰")]),e("Thx",{attrs:{type:"batchReward",postType:"joke",postId:t.jokeRewardArr,adminBoxcoinEnable:!0,userBoxcoinEnable:!0,client:"all"}})],1):t._e()],1)],1)],1)])])])},a=[],o=(i("4de4"),i("a15b"),i("d81d"),i("14d9"),i("4e82"),i("b64b"),i("d3b7"),i("25f0"),i("159b"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-joke-item"},[e("div",{staticClass:"u-content",class:"single"===t.mode?"on":"",on:{click:t.handleContent}},[t.joke.star?e("i",{staticClass:"u-star",class:t.joke.star?"on":"",attrs:{title:"ç²¾é€‰"}},[t._v("â˜…")]):t._e(),e("span",{staticClass:"u-sentence",domProps:{innerHTML:t._s(t.content)}})]),e("div",{staticClass:"u-misc"},[e("div",{staticClass:"u-op"},[e("span",{staticClass:"u-user"},[e("img",{attrs:{width:"24",height:"24",src:t._f("showAvatar")(t.user_avatar)}}),t.joke.user_id?e("a",{attrs:{href:t._f("authorLink")(t.joke.user_id),target:"_blank"}},[t._v(t._s(t.user_name))]):e("span",[t._v(t._s(t.joke.author||"åŒ¿å"))])]),e("el-link",{staticClass:"u-copy",attrs:{type:"primary",disabled:t.disabled},on:{click:function(e){return t.handleCopy(t.joke.content)}}},[e("i",{staticClass:"el-icon-document-copy"}),t._v(" å¤åˆ¶ ")]),e("a",{staticClass:"u-like",class:{on:t.isLike},attrs:{title:"èµ"},on:{click:t.addLike}},[e("i",{staticClass:"like-icon"},[t._v(t._s(t.isLike?"â™¥":"â™¡"))]),t._v("Like "),t.count?e("span",{staticClass:"like-count"},[t._v(t._s(t.count))]):t._e()]),"single"===t.mode&&(t.isAuthor||t.isEditor)?e("a",{staticClass:"u-edit el-link el-link--primary is-underline",attrs:{href:t.editLink("joke",t.joke.id),target:"_blank"}},[e("i",{staticClass:"el-icon-edit-outline"}),t._v(" ç¼–è¾‘ ")]):t._e()],1),e("div",{staticClass:"u-other"},[t.isEditor?[e("span",{staticClass:"u-op-item u-op-star el-link el-link--primary is-underline",on:{click:t.handleStar}},[e("i",{class:t.isStar?"el-icon-star-off":"el-icon-star-on"}),t._v(" "+t._s(t.isStar?"å–æ¶ˆç²¾é€‰":"è®¾ä¸ºç²¾é€‰")+" ")]),e("span",{staticClass:"u-op-item u-op-delete el-link el-link--primary is-underline",on:{click:t.handleDelete}},[e("i",{staticClass:"el-icon-delete"}),t._v(" åˆ é™¤ ")]),"single"!==t.mode?e("el-checkbox",{staticClass:"u-op-item u-op-gift",attrs:{disabled:!t.joke.user_id||t.isSelf},on:{change:t.doReward},model:{value:t.checked,callback:function(e){t.checked=e},expression:"checked"}},[t._v("æ‰“èµ")]):t._e()]:t._e(),e("span",{staticClass:"u-date"},[e("i",{staticClass:"el-icon-date"}),t._v("Â  "),e("time",[t._v(t._s(t._f("dateFormat")(t.joke.created_at)))])])],2)])])}),s=[],r=i("c7eb"),c=i("1da1"),l=i("506c"),u=i("fb92"),d=i("85e4"),f=i("41cb");function h(t){return Object(f["c"])().post("/api/joke/share",t)}var p=function(t){return Object(f["a"])().get("/api/cms/post/jokes",{params:t})};function g(t){return Object(f["a"])().get("/api/cms/post/joke/".concat(t))}var m=function(t){return Object(f["a"])().put("/api/cms/post/joke/".concat(t,"/star"))};function k(t){return Object(f["a"])().put("/api/cms/post/joke/".concat(t,"/unstar"))}var v=function(t){return Object(f["a"])().delete("/api/cms/post/joke/".concat(t))},j=i("c9d2"),y=i("9616"),b={name:"joke_item",props:["joke","mode","jokeRewardArr"],data:function(){return{disabled:!1,isStar:this.joke.star,count:0,isLike:!1,checked:!1,content:""}},filters:{dateFormat:function(t){return Object(u["a"])(new Date(t))},showAvatar:function(t){return Object(d["showAvatar"])(t)},authorLink:d["authorLink"]},computed:{isSelf:function(){return this.joke.user_id==j["a"].getInfo().uid},isListPage:function(){return"single"!==this.mode},isEditor:function(){return j["a"].isEditor()},user_avatar:function(){var t,e;return null===(t=this.joke)||void 0===t||null===(e=t.user_info)||void 0===e?void 0:e.user_avatar},user_name:function(){var t,e;return null===(t=this.joke)||void 0===t||null===(e=t.user_info)||void 0===e?void 0:e.display_name},isAuthor:function(){var t=j["a"].getInfo();return t.uid===this.joke.user_id}},watch:{joke:{handler:function(t){this.count=t.count,this.parse(t.content)},deep:!0,immediate:!0},jokeRewardArr:{handler:function(t){var e=this;this.checked=!(null===t||void 0===t||!t.filter((function(t){return t.article_id==e.joke.id})).length)},deep:!0,immediate:!0}},methods:{parse:function(t){var e=this;return Object(c["a"])(Object(r["a"])().mark((function i(){var n,a;return Object(r["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return n=new l["a"](t),i.next=3,n._renderHTML();case 3:a=i.sent,e.content=a;case 5:case"end":return i.stop()}}),i)})))()},handleCopy:function(t){var e=this;this.disabled=!0,navigator.clipboard.writeText(t).then((function(){e.copyLabel="å·²å¤åˆ¶",setTimeout((function(){e.copyLabel="å¤åˆ¶",e.disabled=!1}),3e3)}))},editLink:d["editLink"],addLike:function(){if(!this.isLike){var t;if(this.count++,!this.isLike)Object(y["b"])("joke",null===(t=this.joke)||void 0===t?void 0:t.id,"likes");this.isLike=!0}},handleStar:function(){var t=this;this.isStar?this.unStar():m(this.joke.id).then((function(){t.$notify({title:"æˆåŠŸ",message:"åŠ ç²¾æˆåŠŸ",type:"success"}),t.isStar=!0,t.joke.star=!0,t.$forceUpdate()}))},unStar:function(){var t=this;k(this.joke.id).then((function(){t.$notify({title:"æˆåŠŸ",message:"å–æ¶ˆåŠ ç²¾æˆåŠŸ",type:"success"}),t.isStar=!1,t.joke.star=!1,t.$forceUpdate()}))},handleDelete:function(){var t=this;this.$confirm("æ­¤æ“ä½œå°†ä¼šåˆ é™¤è¯¥è¡¨æƒ…ï¼Œæ˜¯å¦ç»§ç»­ï¼Ÿ","æç¤º",{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ",type:"warning"}).then((function(){v(t.joke.id).then((function(){t.$notify({title:"æˆåŠŸ",message:"åˆ é™¤æˆåŠŸ",type:"success"}),"single"===t.mode?t.$router.go(-1):t.$emit("update")}))}))},handleContent:function(){this.$router.push("/joke/".concat(this.joke.id))},doReward:function(){this.$emit("doReward",this.joke)}}},_=b,w=i("2877"),C=Object(w["a"])(_,o,s,!1,null,null,null),x=C.exports,S=function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-joke-publish"},[e("el-input",{attrs:{type:"textarea",rows:4,placeholder:"å¿«é€Ÿå‘å¸ƒä¸€æ¡éªšè¯",id:"textarea",maxlength:128,minlength:1,"show-word-limit":""},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}}),e("div",{staticClass:"u-actions"},[e("div",[e("joke-emotion",{on:{emotion:t.insertVariable}}),e("el-select",{staticClass:"u-type",attrs:{size:"small",placeholder:"é€‰æ‹©é—¨æ´¾"},model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},t._l(t.schoolmap,(function(i,n){return e("el-option",{key:n,attrs:{value:n,label:i}},[e("div",{staticStyle:{display:"flex","align-items":"center"}},[e("img",{staticClass:"u-icon",staticStyle:{"margin-right":"5px"},attrs:{width:"24",height:"24",src:t._f("showSchoolIcon")(n),alt:i}}),t._v(" "+t._s(i)+" ")])])})),1)],1),e("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-position",loading:t.processing,disabled:t.processing},on:{click:t.publish}},[t._v("æäº¤")])],1)],1)},L=[],E=(i("caad"),i("2532"),i("466d"),i("5319"),i("77e1")),O=i("0608"),T=i("33a5"),A=i("65c2"),$={components:{"joke-emotion":E["a"]},data:function(){return{content:"",type:"0",schoolmap:T,processing:!1}},computed:{isLogin:function(){return j["a"].isLogin()}},methods:{insertVariable:function(t){var e=this;return Object(c["a"])(Object(r["a"])().mark((function i(){var n,a,o,s;return Object(r["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(n=t.key,a=document.querySelector("#textarea"),!a.selectionStart&&0!==a.selectionStart){i.next=12;break}return o=a.selectionStart,s=a.selectionEnd,e.content=a.value.substring(0,o)+n+a.value.substring(s,a.value.length),i.next=8,e.$nextTick();case 8:a.focus(),a.setSelectionRange(s+n.length,s+n.length),i.next=13;break;case 12:e.content=n;case 13:case"end":return i.stop()}}),i)})))()},publish:function(){var t=this;if(this.isLogin){if(!this.check())return;this.processing=!0,h({type:"all"===this.type?"0":this.type,content:this.content}).then((function(e){var i;null===e||void 0===e||null===(i=e.data)||void 0===i||i.data;t.$message({message:"å‘å¸ƒæˆåŠŸ,è¯·ç­‰å¾…å®¡æ ¸",type:"success"}),t.content=""})).finally((function(){t.processing=!1}))}else j["a"].toLogin()},check:function(){var t,e=Object.keys(O),i=this.content.trim(),n=/(#[\u4e00-\u9fa5]{1})/g,a=/(#[\u4e00-\u9fa5]{2})/g,o=/(#[\u4e00-\u9fa5]{3})/g;if(!i.length)return this.$notify({title:"é”™è¯¯",message:"å†…å®¹ä¸èƒ½ä¸ºç©º",type:"error"}),!1;var s=i.match(n)?i.match(n).filter((function(t){return e.includes(t)})):[];s.forEach((function(t){return i.replace(t,"")}));var r=i.match(a)?i.match(a).filter((function(t){return e.includes(t)})):[];r.forEach((function(t){return i.replace(t,"")}));var c=i.match(o)?i.match(o).filter((function(t){return e.includes(t)})):[];c.forEach((function(t){return i.replace(t,"")}));var l=s.length+r.length+c.length;if(this.contentLength=l,l>10)return this.$notify({title:"é”™è¯¯",message:"è¡¨æƒ…ä¸ªæ•°ä¸èƒ½è¶…è¿‡10ä¸ª",type:"error"}),!1;var u=(null===(t=i.match(/[^\x00-\xff]/g))||void 0===t?void 0:t.length)||0;return!(2*u+(i.length-u)>128)||(this.$notify({title:"é”™è¯¯",message:"å†…å®¹é•¿åº¦ä¸èƒ½è¶…è¿‡128ä¸ªå­—ç¬¦",type:"error"}),!1)}},filters:{showSchoolIcon:function(t){return A["__imgPath"]+"image/school/"+t+".png"}}},R=$,z=Object(w["a"])(R,S,L,!1,null,null,null),I=z.exports,M=i("23d8"),P=i("9398"),B=i("a0b5"),W=i("a27f"),J={name:"Joke",components:{"joke-item":x,Comment:M["a"],"joke-post":I,ListLayout:P["a"],LeftTab:B["a"]},data:function(){return{loading:!1,schoolmap:T,sortedEmotions:[],type:"all",star:0,search:"",per:10,page:1,total:0,jokes:[],joke:"",windowWidth:document.documentElement.clientWidth,jokeRewardArr:[]}},computed:{isNotSelf:function(){return function(t){return t!=j["a"].getInfo().uid}},isEditor:function(){return j["a"].isEditor()},publish_link:function(){return Object(d["publishLink"])("joke")},id:function(){return this.$route.params.id},params:function(){return{per:~~this.per,page:~~this.page,type:"all"==this.type?"":this.type,search:this.search,star:this.star?1:""}},keys:function(){return[this.type,this.star,this.page,this.per]},reset_keys:function(){return[this.type,this.star]},user_id:function(){var t;return(null===(t=this.joke)||void 0===t?void 0:t.user_id)||0},title:function(){var t;return null===(t=this.joke)||void 0===t?void 0:t.content},rewardAllType:function(){return this.jokeRewardArr.length===this.jokes.filter((function(t){return t.user_id})).length}},filters:{showSchoolIcon:function(t){return A["__imgPath"]+"image/school/"+t+".png"}},methods:{setType:function(t){this.type=t},handleSizeChange:function(t){this.per=t,this.loadList()},sortEmotion:function(){var t=this,e=Object.keys(O);e.sort((function(t,e){return t.localeCompare(e)})),e.forEach((function(e){var i={key:e,value:O[e]};t.sortedEmotions.push(i)}))},loadList:function(){var t=this;this.loading=!0,p(this.params).then((function(e){var i,n,a,o;t.jokes=null===e||void 0===e||null===(i=e.data)||void 0===i||null===(n=i.data)||void 0===n?void 0:n.list,t.total=null===e||void 0===e||null===(a=e.data)||void 0===a||null===(o=a.data)||void 0===o?void 0:o.total,t.loadLike()})).finally((function(){t.loading=!1}))},loadSingle:function(){var t=this;this.loading=!0,g(this.id).then((function(e){var i;t.joke=null===e||void 0===e||null===(i=e.data)||void 0===i?void 0:i.data})).finally((function(){t.loading=!1}))},handleJokeUpdate:function(){this.loadList()},init:function(){this.id?this.loadSingle():this.loadList()},goBack:function(){var t=this;this.$router.push("/joke"),this.$nextTick((function(){t.init()}))},skipTop:function(){window.scrollTo(0,0)},loadLike:function(){var t=this;if(this.jokes&&this.jokes.length){var e=this.jokes.map((function(t){return"joke-"+t.id}));e=e.join(",");var i={post_type:"joke",post_action:"likes",id:e};Object(W["b"])(i).then((function(e){var i=e.data.data;Object.keys(i).length&&t.jokes.forEach((function(e){var n;t.$set(e,"count",null===i||void 0===i||null===(n=i["joke-"+e.id])||void 0===n?void 0:n.likes)}))}))}},doReward:function(t){var e=this.jokeRewardArr.filter((function(e){return e.article_id==t.id}));e.length?this.jokeRewardArr=this.jokeRewardArr.filter((function(e){return e.article_id!=t.id})):this.jokeRewardArr.push({user_id:t.user_id,article_id:t.id.toString(),article_type:"joke"})},rewardAll:function(){var t=this,e=[];this.jokes.map((function(i){i.user_id&&t.isNotSelf(i.user_id)&&e.push({user_id:i.user_id,article_id:i.id.toString(),article_type:"joke"})})),this.jokeRewardArr=this.rewardAllType?[]:e},onSearch:function(){1===this.page?this.init():this.page=1}},watch:{keys:{deep:!0,handler:function(){this.init()},immediate:!0},reset_keys:{deep:!0,handler:function(){this.jokeRewardArr=[],this.page=1}},page:{deep:!0,handler:function(){this.jokeRewardArr=[]}},id:{immediate:!0,handler:function(t){t&&this.init()}}},mounted:function(){var t=this;window.onresize=function(){t.windowWidth=document.documentElement.clientWidth}},created:function(){this.sortEmotion()}},N=J,D=(i("af4f"),Object(w["a"])(N,n,a,!1,null,null,null));e["default"]=D.exports},fb92:function(t,e,i){"use strict";i.d(e,"a",(function(){return r})),i.d(e,"b",(function(){return s}));i("99af");var n=i("5a0c"),a=i.n(n),o=i("4208");function s(t){return a()().from(a()(t))}function r(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=t.getFullYear(),a=t.getMonth()+1,o=t.getDate(),s=i?"".concat(n).concat(e).concat(c(a)).concat(e).concat(c(o)):"".concat(n).concat(e).concat(a).concat(e).concat(o);return s}function c(t){return t<10?"0"+t:t}i("a471"),a.a.locale("zh-cn"),a.a.extend(o)}}]);
//# sourceMappingURL=chunk-e57a3752.a19b73d5.js.map