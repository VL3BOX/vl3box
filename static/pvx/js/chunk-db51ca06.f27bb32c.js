(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-db51ca06"],{"015b":function(t,e,i){"use strict";var a=function(){var t=this,e=t._self._c;return e("div",{ref:"wrap",staticClass:"cross-wrapper",class:"m-".concat(t.type)},[t.isShow?[e("div",{staticClass:"cross cross-left",class:!t.isInLeft&&"active",style:{width:t.width+"px","border-top-left-radius":t.radius+"px","border-bottom-left-radius":t.radius+"px"},on:{click:function(e){return e.stopPropagation(),t.toLeft.apply(null,arguments)}}},[e("i",{staticClass:"el-icon-caret-left"})]),e("div",{staticClass:"cross cross-right",class:!t.isInRight&&"active",style:{width:t.width+"px","border-top-right-radius":t.radius+"px","border-bottom-right-radius":t.radius+"px"},on:{click:function(e){return e.stopPropagation(),t.toRight.apply(null,arguments)}}},[e("i",{staticClass:"el-icon-caret-right"})])]:t._e(),e("div",{ref:"list",staticClass:"list"},t._l(t.list,(function(i,a){return e("div",{key:i.id||i.ID+i.ItemID||a,staticClass:"item",style:{"margin-right":t.gap+"px"}},[t._t("default",null,{item:i})],2)})),0)],2)},s=[],n=(i("a9e3"),{name:"Cross",props:{list:{type:Array,required:!0},width:{type:Number,default:60},gap:{type:Number,default:20},radius:{type:Number,default:10},offset:{type:Object,default:function(){return{top:0,left:0,right:0,bottom:0}}},type:{type:String,default:"rare"},arrow:{type:Number,default:1}},data:function(){return{scrollLeft:0,isInLeft:!0,isInRight:!1,isShow:!1}},methods:{toLeft:function(t){t.preventDefault(),this.isInRight=!1,this.scroll(-this.arrow)},toRight:function(t){t.preventDefault(),this.isInLeft=!1,this.scroll(this.arrow)},scroll:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=this.$refs.list,a=i.scrollLeft,s=i.scrollWidth,n=i.clientWidth,r=n/2*e,o=null;o=setInterval((function(){e===t.arrow?(i.scrollLeft<a+r?i.scrollLeft+=Math.ceil(r/100):clearInterval(o),Math.ceil(i.scrollLeft+n)>=s&&(t.isInRight=!0,clearInterval(o))):e===-t.arrow&&(i.scrollLeft>a+r?i.scrollLeft+=Math.floor(r/100):clearInterval(o),i.scrollLeft<=0&&(t.isInLeft=!0,clearInterval(o)))}),1)}},mounted:function(){var t=this;this.$nextTick((function(){var e=t.$refs.list,i=e.clientWidth,a=e.scrollWidth;a>i&&(t.isShow=!0)}))}}),r=n,o=(i("685d"),i("2877")),c=Object(o["a"])(r,a,s,!1,null,null,null);e["a"]=c.exports},"0262":function(t,e,i){},"03a6":function(t,e,i){},"09d9":function(t,e,i){},"2d75":function(t,e,i){"use strict";i("90fd")},"2efc":function(t,e,i){"use strict";i("b0c0"),i("a9e3");var a=function(){var t=this,e=t._self._c;return e("a",{staticClass:"m-horse-card",class:"u-quality-bg--"+t.item.Quality,attrs:{href:t.getLink(t.item),target:"_blank"}},[15===t.item.SubType?e("el-image",{staticClass:"u-image",attrs:{src:t.getImgSrc(t.item)}},[e("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[e("img",{attrs:{src:t.getImgSrc(t.item,!0)},on:{error:t.replaceByDefault}})])]):e("item-icon",{attrs:{item_id:String(t.item.ItemID),isLink:!1,size:160,onlyIcon:!0}}),e("div",{staticClass:"u-name"},[t._v(t._s(t.item.Name))]),e("div",{staticClass:"u-desc"},[t._v("ID: "+t._s(t.item.ID))]),e("div",{staticClass:"u-img"},t._l(t.item.MagicAttributes||[],(function(i,a){return e("el-tooltip",{key:a,attrs:{trigger:"hover",placement:"top"}},[e("div",{staticClass:"u-attr-pop",attrs:{slot:"content"},slot:"content"},[i.name?e("div",{staticClass:"u-attr-name"},[t._v(" "+t._s((i.name||"")+(Number(i.level)?i.level+"级":""))+" ")]):t._e(),e("div",{staticClass:"u-attr-desc"},[t._v(t._s(i.desc))])]),e("img",{staticClass:"u-attr-icon",attrs:{src:i.iconUrl,alt:i.name}})])})),1)],1)},s=[],n=(i("99af"),i("ac1f"),i("466d"),i("5319"),i("bf15")),r={props:{item:{type:Object,required:!0}},components:{ItemIcon:n["a"]},inject:["__imgRoot","__imgRoot2"],data:function(){return{}},computed:{client:function(){return this.$store.state.client}},methods:{replaceByDefault:function(t){t.target.src=i("d47d")},getLink:function(t){var e=t.ItemID,i=15===t.SubType?1:2;return"/horse/".concat(e,"?type=").concat(i)},getImgSrc:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=e?this.client:"std",a=t.ImgPath;if(a){var s=a.toLowerCase().match(/.*[\/,\\]homeland(.*?).tga/),n=null===s||void 0===s?void 0:s[1].replace(/\\/g,"/");return"default"==(null===s||void 0===s?void 0:s[1])?this.__imgRoot+"homeland/".concat(i)+"/default/default.png":this.__imgRoot+"homeland/".concat(i)+n+".png"}return this.__imgRoot2+"".concat(i,"/")+t.ID+".png"},getType:function(t){var e="";return 15===t.SubType?e=0===t.DetailType?"普通坐骑":"奇趣坐骑":23===t.SubType&&(e=0===t.DetailType?"头饰":1===t.DetailType?"鞍饰":2===t.DetailType?"足饰":3===t.DetailType?"马饰":"马具"),e}}},o=r,c=(i("2d75"),i("2877")),l=Object(c["a"])(o,a,s,!1,null,null,null);e["a"]=l.exports},"4c2b":function(t,e,i){},"51eb":function(t,e,i){"use strict";var a=i("825a"),s=i("485a"),n=TypeError;t.exports=function(t){if(a(this),"string"===t||"default"===t)t="string";else if("number"!==t)throw new n("Incorrect hint");return s(this,t)}},6231:function(t,e,i){"use strict";i.r(e);i("7db0"),i("b0c0"),i("d3b7");var a=function(){var t=this,e=this,i=e._self._c;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"listRef",staticClass:"horse-home-wrapper"},[i("PvxSearch",{attrs:{items:e.searchProps,initValue:e.initValue},on:{search:function(t){return e.searchEvent(t)}}}),i("div",{ref:"crossWrap",staticClass:"list-wrapper"},[e.isAll?["std"===e.client?i("HorseBroadcast"):e._e(),e._l(e.listAll,(function(t,a){return i("div",{key:a,staticClass:"list-item-wrapper"},[t.length?i("div",{staticClass:"title-header"},[i("div",{staticClass:"title"},[e._v(" "+e._s(e.types[a+1].name)+" ")]),i("a",{attrs:{href:"javascript:;"},on:{click:function(t){return e.toLookAll(e.types[a+1].type)}}},[e._v("查看全部")])]):e._e(),e.showCross[a]?i("list-cross",{key:e.types[a+1].name,ref:e.types[a+1].name,refInFor:!0,attrs:{list:t,radius:0},scopedSlots:e._u([{key:"default",fn:function(t){return[i("HorseCard",{attrs:{item:t.item}})]}}],null,!0)}):i("div",{staticClass:"no-cross-wrap"},[i("div",{staticClass:"list"},e._l(t,(function(t){return i("HorseCard",{key:t.id,attrs:{item:t}})})),1)])],1)}))]:i("div",{staticClass:"list-item-wrapper"},[e.list.length?i("div",{staticClass:"title-header"},[i("div",{staticClass:"title"},[e._v(" "+e._s(e.types.find((function(e){return e.type===t.selected}))?e.types.find((function(e){return e.type===t.selected})).name:"全部")+" ")]),e.showSwitch?i("div",{staticClass:"operate-wrap"},[i("div",{staticClass:"list-type-wrapper"},e._l(e.listTypes,(function(t){return i("div",{key:t.value,staticClass:"list-type-item",class:e.listType===t.value&&"active",on:{click:function(i){e.listType=t.value}}},[e._v(" "+e._s(t.label)+" ")])})),0)]):e._e()]):e._e(),"list"===e.listType?i("div",{staticClass:"list-content"},[i("ListHead"),e._l(e.list,(function(t){return i("HorseItem",{key:t.ID,attrs:{item:t}})})),e.list.length?i("pagination",{directives:[{name:"show",rawName:"v-show",value:e.totalPages>0,expression:"totalPages > 0"}],attrs:{total:e.total,page:e.query.page,limit:e.query.per},on:{"update:page":function(t){return e.$set(e.query,"page",t)},"update:limit":function(t){return e.$set(e.query,"per",t)},pagination:e.loadList}}):e._e()],2):e._e(),"card"===e.listType?i("div",{staticClass:"list-card-content"},[e._l(e.list,(function(t){return i("HorseCard",{key:t.ID,attrs:{item:t}})})),e.list.length?i("el-button",{staticClass:"more-btn",style:{width:e.buttonWidth?e.buttonWidth+"px":"100%"},attrs:{disabled:!e.hasNextPage,loading:e.loading,icon:"el-icon-arrow-down"},on:{click:e.loadCardList}},[e._v(e._s(e.hasNextPage?"加载更多":"没有更多了"))]):e._e()],2):e._e()])],2)],1)},s=[],n=i("c7eb"),r=i("1da1"),o=i("5530"),c=(i("99af"),i("c740"),i("d81d"),i("14d9"),i("fb6a"),i("e9c4"),i("b64b"),i("820e"),i("ac1f"),i("3ca3"),i("841c"),i("159b"),i("ddb0"),i("f252")),l=i("d427"),u=i("015b"),d=(i("a9e3"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-horse-broadcast"},[e("div",{staticClass:"m-horse-broadcast__header"},[e("div",{staticClass:"u-title"},[t._v("抓马播报")]),e("el-select",{staticClass:"u-select",attrs:{placeholder:"请选择服务器",size:"mini"},model:{value:t.server,callback:function(e){t.server=e},expression:"server"}},t._l(t.servers,(function(t){return e("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),t.listData.length?e("list-cross",{staticClass:"m-horse-broadcast__list",attrs:{list:t.listData},scopedSlots:t._u([{key:"default",fn:function(i){return[e("div",{staticClass:"m-horse-broadcast__item"},[e("jx3box-map",{key:i.item.map_id,staticClass:"u-horse-map",attrs:{mapId:Number(i.item.map_id),overview:!1,datas:i.item.mapDatas[String(i.item.map_id)]}}),e("div",{staticClass:"u-horse-mapinfo"},[e("div",{staticClass:"u-horses"},[e("div",{staticClass:"u-horses-content"},[t._l(i.item.horses,(function(i){return e("div",{key:i,staticClass:"u-horse",on:{click:function(e){return t.go(i)}}},[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:i,placement:"top"}},[e("el-image",{staticClass:"u-image",attrs:{src:t.getImgSrc(i)}},[e("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[e("img",{attrs:{src:t.getImgSrc(i,!0)},on:{error:t.replaceByDefault}})])])],1)],1)})),i.item.is_chitu?e("div",{staticClass:"u-horse u-chitu"},[t._v("<赤兔>")]):t._e()],2)]),e("div",{staticClass:"u-times-info",class:i.item.is_chitu&&"is-chitu"},[e("div",{staticClass:"u-map-name"},[i.item.is_chitu?e("span",{staticClass:"u-op"},[e("i",{class:t.chituLoading?"el-icon-loading":"el-icon-refresh",on:{click:t.loadChituData}}),e("el-tooltip",{attrs:{effect:"dark",placement:"top","popper-class":"u-chitu-tip"},scopedSlots:t._u([{key:"content",fn:function(){return[e("div",{domProps:{innerHTML:t._s(t.chituTip)}})]},proxy:!0}],null,!0)},[e("i",{staticClass:"el-icon-question"})])],1):t._e(),e("span",{staticClass:"u-name"},[t._v(t._s(i.item.map_name))])]),i.item.is_chitu?e("div",{staticClass:"u-times"},[i.item.time?e("span",[t._v(t._s(i.item.time))]):e("span",{staticClass:"u-times-lately"},[t._v("本CD尚未刷新")])]):e("div",{staticClass:"u-times",class:"foreshow"===i.item.subtype&&"u-times-lately"},[e("span",[t._v(t._s(i.item.fromTime))]),e("span",[t._v(" ~ ")]),e("span",[t._v(t._s(i.item.toTime))])])])])],1)]}}],null,!1,1472241615)}):e("div",{staticClass:"w-no-data"},[t._v(t._s(t.server)+" 暂无播报")])],1)}),p=[],h=(i("4de4"),i("0481"),i("a15b"),i("4e82"),i("4069"),i("4ec9"),i("25f0"),i("466d"),i("498a"),i("abab")),f=i("c9d2"),m=i("12d4"),v=i("a59a"),g=i("ef56"),y=i("238b"),b=i("24cf"),_={name:"HorseBroadcast",components:{Jx3boxMap:h["a"],ListCross:u["a"]},inject:["__imgRoot2"],data:function(){return{list:[],server:"",timer:null,chituMap:{"方问":411,"小赤":216,"杨新":411},hasExist:!1,existData:{},chituTip:"\n             <p>CD: 周二7点 ~ 下周一7点。</p>\n             <p>地图: 黑戈壁、阴山大草原、鲲鹏岛。</p>\n             <p>必备: <卦文龟甲>交大战时有几率获得，赤兔刷新后再到信使处领取，有效期7天。</p>\n            ",chituLoading:!1}},computed:{params:function(){return{pageIndex:1,pageSize:50,type:"horse",server:this.server}},client:function(){return this.$store.state.client},servers:function(){return"std"==this.client?m:v},listData:function(){return this.existData.map_id?[this.existData].concat(this.list):this.list}},watch:{server:function(){this.list=[],this.existData={},this.getGameReporter(),this.loadChituData()}},methods:{loadChituData:function(){var t=this,e=this.server;this.chituLoading=!0,Object(c["b"])(e).then((function(e){var i,a,s,n,r=(null===(i=e.data)||void 0===i||null===(a=i.data)||void 0===a?void 0:a.list)||[],c=(null===r||void 0===r||null===(s=r[0])||void 0===s?void 0:s.content)||"",l=/\]\[(.*)\]大声喊/.exec(c)[1].trim()||"",u=216,d=(null===(n=t.chituMap)||void 0===n?void 0:n[l])||u,p=g[d],h={},f=p.coordinates[0],m=["赤兔·飞虹"],v=p.mapName;h[d]=[Object(o["a"])({content:"".concat(m.join(),"\n                    <br />坐标：(").concat(f.x,",").concat(f.y,",").concat(f.z,")")},f)];var y=b["a"].tz((null===r||void 0===r?void 0:r[0].created_at)||b["a"].tz()),_=b["a"].tz(),w=_.day(),C=_.hour(),x=_.day(2).hour(7).minute(0).second(0).millisecond(0),S=x.add(1,"week").add(-1,"millisecond");(w<=1||2===w&&C<7)&&(x=b["a"].tz(x).add(-1,"week"),S=b["a"].tz(S).add(-1,"week"));var L=b["a"].tz(y).isBetween(x,S);t.hasExist=L;var I={horses:m,map_name:v,map_id:d+"",mapDatas:h,is_chitu:!0,time:""};L&&(I.time=b["a"].tz(y).format("YYYY-MM-DD HH:mm:ss")),t.existData=I})).finally((function(){t.chituLoading=!1}))},replaceByDefault:function(t){t.target.src=i("d47d")},go:function(t){var e,i=(null===(e=y[t])||void 0===e?void 0:e.itemId)||0,a=1;this.$router.push({path:"".concat(i),query:{type:a}})},getImgSrc:function(t){var e,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=i?this.client:"std",s=(null===(e=y[t])||void 0===e?void 0:e.id)||0;return this.__imgRoot2+"".concat(a,"/")+s+".png"},getOriginDatas:function(t){var e="",i="",a=[],s={},n=[];if("npc_chat"===t.subtype)e=String(t.map_id),i=t.map_name,a=g[e].coordinates,n=g[e].horses[t.horseIndex];else for(var r in i=t.content.match(/在(\S*)出没/)?t.content.match(/在(\S*)出没/)[1]:"",g)g[r].mapName===i&&(e=r,a=g[r].coordinates,n=g[e].horses.flat());var c=a[0];s[e]=[Object(o["a"])({content:"".concat(n.join(),"\n                    <br />坐标：(").concat(c.x,",").concat(c.y,",").concat(c.z,")")},c)];var l={mapDatas:s,map_id:e,map_name:i,horses:n};return l},getGameReporter:function(){var t=this,e=this.params;Object(c["d"])(e).then((function(e){var i,a=null===e||void 0===e||null===(i=e.data)||void 0===i?void 0:i.data,s=(null===a||void 0===a?void 0:a.list)||[],n=new Map,r=s.filter((function(t){return t.map_id&&!n.has(t.map_id)&&n.set(t.map_id,1)})),c=s.filter((function(t){return!t.map_id&&((new Date).valueOf()-new Date(t.created_at).valueOf())/1e3/60<=15})),l=[];r.forEach((function(t){t.content.split("\n\n").forEach((function(e,i){if(e&&(e.match(/还有(\S*)分钟/)||e.match("即将出世"))){var a=e.match(/还有(\S*)分钟/)?Number(e.match(/还有(\S*)分钟/)[1]):0,s=new Date(t.created_at).valueOf()+60*(a+15)*1e3>=(new Date).valueOf();s&&l.push(Object(o["a"])(Object(o["a"])({},t),{},{id:i?Number(i+t.id.toString()):t.id,content:e,minute:a,horseIndex:i}))}}))}));var u=l.concat(c);t.list=u.map((function(e){var i="",a="";return"minute"in e?(i=b["a"].tz(new Date(e.created_at).valueOf()+60*(e.minute+5)*1e3).format("HH:mm"),a=b["a"].tz(new Date(e.created_at).valueOf()+60*(e.minute+10)*1e3).format("HH:mm")):(i=b["a"].tz(new Date(e.created_at).valueOf()+3e5).format("HH:mm"),a=b["a"].tz(new Date(e.created_at).valueOf()+6e5).format("HH:mm")),Object(o["a"])(Object(o["a"])(Object(o["a"])({},e),t.getOriginDatas(e)),{},{fromTime:i,toTime:a})})).sort((function(t,e){return b["a"].tz(e.created_at).valueOf()-b["a"].tz(t.created_at).valueOf()}))}))}},mounted:function(){var t=this;f["a"].isLogin()?Object(c["g"])().then((function(e){var i,a;t.server=(null===(i=e.data)||void 0===i||null===(a=i.data)||void 0===a?void 0:a.jx3_server)||"梦江南"})):this.server="梦江南",this.timer=setInterval((function(){t.getGameReporter()}),3e4)},beforeDestroy:function(){clearInterval(this.timer),this.timer=null}},w=_,C=(i("9a1a"),i("2877")),x=Object(C["a"])(w,d,p,!1,null,null,null),S=x.exports,L=i("2efc"),I=function(t,e){return e._m(0)},D=[function(t,e){return t("div",{staticClass:"m-list-head list-sticky-head"},[t("div",[e._v("名称")]),t("div",[e._v("类型")]),t("div",[e._v("骑乘")]),t("div",[e._v("品质等级")]),t("div",[e._v("跑速")]),t("div",[e._v("喂食饲料")]),t("div",[e._v("获取方式")]),t("div",[e._v("属性")])])}],O={name:"ListHead"},j=O,k=(i("6679"),Object(C["a"])(j,I,D,!0,null,null,null)),T=k.exports,P=function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-horse-item",on:{click:function(e){return t.go(t.item)}}},[e("div",{staticClass:"u-name"},[e("item-icon",{attrs:{item_id:String(t.item.ItemID),size:36,vertical:!0}})],1),e("div",{staticClass:"u-desc"},[t._v(t._s(t.item.typeName))]),e("div",{staticClass:"u-desc"},[t._v(t._s(t.item.modeName))]),e("div",{staticClass:"u-desc"},[t._v(t._s(t.item.Level))]),e("div",{staticClass:"u-desc"},[t._v(t._s(t.item.speed))]),e("div",{staticClass:"u-desc"},[t._v(t._s(t.item.feedName))]),e("div",{staticClass:"u-desc"},[t._v(t._s(t.item.GetType))]),e("div",{staticClass:"u-attr-wrap"},t._l(t.item.MagicAttributes||[],(function(i,a){return e("div",{key:a,staticClass:"u-attr"},[e("el-tooltip",{attrs:{trigger:"hover",placement:"top"}},[e("div",{staticClass:"u-attr-pop",attrs:{slot:"content"},slot:"content"},[i.name?e("div",{staticClass:"u-attr-name"},[t._v(" "+t._s((i.name||"")+(Number(i.level)?i.level+"级":""))+" ")]):t._e(),e("div",{staticClass:"u-attr-desc"},[t._v(t._s(i.desc))])]),e("img",{staticClass:"u-attr-icon",attrs:{src:i.iconUrl,alt:i.name}})])],1)})),0)])},H=[],N=i("bf15"),M={name:"HorseItem",components:{ItemIcon:N["a"]},props:{item:{type:Object,required:!0}},methods:{go:function(t){var e=t.ItemID,i=15===t.SubType?1:2;this.$router.push({path:"".concat(e),query:{type:i}})}},computed:{client:function(){return this.$store.state.client}}},z=M,W=(i("dd43"),Object(C["a"])(z,P,H,!1,null,null,null)),A=W.exports,$=i("1799"),q=i("85e4"),R=i("ed08"),B={name:"HorseHome",components:{PvxSearch:l["a"],ListCross:u["a"],HorseCard:L["a"],ListHead:T,HorseItem:A,Pagination:$["a"],HorseBroadcast:S},data:function(){return{loading:!1,listType:"card",listTypes:[{value:"list",label:"列表"},{value:"card",label:"卡片"}],query:{page:1,per:20},total:0,totalPages:0,search:{},listAll:[],list:[],feeds:[],isAll:!0,selected:"",initValue:{},searchProps:[{key:"type",name:"类型",type:"radio",options:[{type:"",name:"全部"},{type:0,name:"普通坐骑"},{type:1,name:"奇趣坐骑"},{type:2,name:"马具"}]},{type:"filter",key:"filter",name:"过滤",options:[{key:"feed",type:"checkbox",name:"喂食饲料",options:[]},{key:"attr",type:"checkbox",name:"属性",options:[]}]},{key:"keyword",name:"名称/ID"}],buttonWidth:0,showCross:[],showRecentCross:!1,gap:20,base:200}},computed:{client:function(){return this.$store.state.client},types:function(){return this.searchProps[0].options},params:function(){return Object(o["a"])(Object(o["a"])(Object(o["a"])({},this.query),this.search),{},{client:this.client})},showSwitch:function(){var t=this.isAll;return!t&&!this.isPhone()},hasNextPage:function(){return this.totalPages>1&&this.query.page<this.totalPages}},watch:{listType:{handler:function(t){this.query.page=1,this.list=[],"list"===t?(this.query.per=20,this.loadList()):this.showCount()}}},methods:{isPhone:R["b"],iconLink:q["iconLink"],getFeed:function(t){var e="";return 15===t.SubType&&(e=this.feeds.find((function(e){return e.id===t.DetailType}))?this.feeds.find((function(e){return e.id===t.DetailType})).feed:""),e},canDouble:function(t){var e="";return 15===t.SubType&&t.MagicAttributes&&t.MagicAttributes.length&&(e=t.MagicAttributes.find((function(t){return"15650"===t.id}))?t.MagicAttributes.find((function(t){return"15650"===t.id})).name:"单骑"),e},getType:function(t){var e="";return 15===t.SubType?e=0===t.DetailType?"普通坐骑":"奇趣坐骑":23===t.SubType&&(e=0===t.DetailType?"头饰":1===t.DetailType?"鞍饰":2===t.DetailType?"足饰":3===t.DetailType?"马饰":"马具"),e},getList:function(t){var e=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=Object(R["a"])(Object(o["a"])(Object(o["a"])({},this.params),{},{type:t}));return this.loading=!0,new Promise((function(t,s){Object(c["f"])(a).then((function(a){var s=a.data.list.map((function(t){return t.typeName=e.getType(t),t.modeName=e.canDouble(t),t.feedName=e.getFeed(t),t.MoveSpeed&&(t.speed=t.MoveSpeedDesc.split("移动速度提高")[1]),t.MagicAttributes&&t.MagicAttributes.length&&t.MagicAttributes.map((function(t){return t.iconUrl=e.iconLink(t.icon),t})),t}));e.loading=!1,t(i?s:a.data)})).catch((function(t){e.loading=!1,s(t)}))}))},toLookAll:function(t){this.$set(this.initValue,"type",t)},toList:function(t){this.query.page=1,""===t||void 0===t?(this.isAll=!0,this.getAllList()):(this.isAll=!1,this.list=[],"card"===this.listType?this.showCount():this.loadList())},loadList:function(){var t=this;this.getList(this.selected,!1).then((function(e){t.list=e.list,t.total=e.total,t.totalPages=e.pages}))},loadCardList:function(){var t=this;this.getList(this.selected,!1).then((function(e){t.query.page++,t.list=t.list.concat(e.list),t.total=e.total,t.totalPages=e.pages}))},getFeedList:function(){var t=this;return Object(r["a"])(Object(n["a"])().mark((function e(){return Object(n["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(c["c"])({client:t.client}).then((function(e){var i=e.data.map((function(t){var e=t.tip.indexOf("【"),i=t.tip.indexOf("】");return t.feed=t.tip.slice(e+1,i),t}));t.feeds=JSON.parse(JSON.stringify(i));var a=[];i.forEach((function(t){var e=a.findIndex((function(e){return e.feed===t.feed}));e>-1?a[e].id+=","+t.id:a.push(t)}));var s=a.map((function(t){return{label:t.feed,value:t.id}}));t.searchProps[1].options[0].options=s}));case 2:case"end":return e.stop()}}),e)})))()},getAttrList:function(){var t=this;return Object(r["a"])(Object(n["a"])().mark((function e(){return Object(n["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(c["a"])({client:t.client}).then((function(e){var i=e.data,a=i.map((function(t){return{label:t.name,value:t.name}}));t.searchProps[1].options[1].options=a}));case 2:case"end":return e.stop()}}),e)})))()},searchEvent:function(t){this.search=t,this.selected=t.type,this.toList(t.type)},jdugeType:function(){var t=this;setTimeout((function(){t.isPhone()&&(t.selected="",t.listType="card")}),10)},showCount:function(){var t=this;this.$nextTick((function(){var e,i=null===(e=t.$refs.listRef)||void 0===e?void 0:e.clientWidth;t.query.per=4*Math.floor(i/t.base),t.isPhone()||(t.buttonWidth=t.query.per/4*(t.base+t.gap)-20),t.loadCardList()}))},getAllList:function(){var t=this;this.query.per=20,this.listAll=[],this.showCross=[];var e=this.getList(0),i=this.getList(1),a=this.getList(2);this.loading=!0,Promise.allSettled([e,i,a]).then((function(e){for(var i,a=e.map((function(t){return"fulfilled"===t.status?t.value:[]})),s=null===(i=t.$refs.crossWrap)||void 0===i?void 0:i.clientWidth,n=t.gap,r=t.base+n,o=a.length,c=0;c<o;c++){var l=a[c].length*r-n;t.showCross[c]=l>s}t.listAll=a})).finally((function(){t.loading=!1}))}},mounted:function(){var t=this.getAttrList(),e=this.getFeedList(),i=this;Promise.all([t,e]).then((function(){i.jdugeType()})),window.onresize=function(){i.jdugeType()}}},E=B,Y=(i("7f89"),Object(C["a"])(E,a,s,!1,null,null,null));e["default"]=Y.exports},6421:function(t,e,i){},6679:function(t,e,i){"use strict";i("09d9")},"685d":function(t,e,i){"use strict";i("4c2b")},"7f89":function(t,e,i){"use strict";i("0262")},8172:function(t,e,i){"use strict";var a=i("e065"),s=i("57b9");a("toPrimitive"),s()},"820e":function(t,e,i){"use strict";var a=i("23e7"),s=i("c65b"),n=i("59ed"),r=i("f069"),o=i("e667"),c=i("2266"),l=i("5eed");a({target:"Promise",stat:!0,forced:l},{allSettled:function(t){var e=this,i=r.f(e),a=i.resolve,l=i.reject,u=o((function(){var i=n(e.resolve),r=[],o=0,l=1;c(t,(function(t){var n=o++,c=!1;l++,s(i,e,t).then((function(t){c||(c=!0,r[n]={status:"fulfilled",value:t},--l||a(r))}),(function(t){c||(c=!0,r[n]={status:"rejected",reason:t},--l||a(r))}))})),--l||a(r)}));return u.error&&l(u.value),i.promise}})},"90fd":function(t,e,i){},"9a1a":function(t,e,i){"use strict";i("6421")},abab:function(t,e,i){"use strict";var a=function(){var t=this,e=t._self._c;return e("div",{ref:"component",staticClass:"c-map"},[e("div",{ref:"wrapper",staticClass:"u-map__wrapper",style:t.wrapperSize},[e("div",{staticClass:"u-map__inner",style:t.innerStyle},[e("img",{staticClass:"u-map-img",attrs:{refs:"img",src:t.mapImg,draggable:"false"}}),t.overview?e("div",{staticClass:"u-map-title__wrapper"},[t._t("title",(function(){return[e("div",{staticClass:"u-map-title"},[t._v(t._s(t.mapName))])]}),{title:t.mapName})],2):t._e(),t._l(t.datas,(function(i,a){return[e("div",{key:a,staticClass:"u-map-point__wrapper",style:t.pointStyle(i),attrs:{"data-index":a}},[t._t("point",(function(){return[e("el-popover",{attrs:{"popper-class":"u-map-point__popover",placement:"top",width:"200",trigger:"hover"}},[t._t("popover",(function(){return[e("div",[t.overview?t._e():e("div",{staticClass:"u-map-title"},[t._v(t._s(t.mapName))]),e("div",[t._v(t._s(i.title))]),e("div",{domProps:{innerHTML:t._s(i.content)}})])]}),{data:i}),e("span",{staticClass:"u-map-point",attrs:{slot:"reference"},slot:"reference"})],2)]}),{data:i})],2)]}))],2)])])},s=[],n=i("5530"),r=(i("99af"),i("7db0"),i("d81d"),i("a9e3"),i("b64b"),i("d3b7"),i("65c2"));const{__imgPath:o}=r,c=()=>fetch(o+"/map/data/map_scales.json").then(t=>t.json());var l={name:"Jx3boxMap",props:{mapId:{type:Number,default:1},datas:{type:Array,default:function(){return[]}},overview:{type:Boolean,default:!0},focus:{type:Number,default:void 0},trimBorder:{type:Boolean,default:!1},mapDraggable:{type:Boolean,default:!1},pointDraggable:{type:Boolean,default:!1},mapFollow:{type:Boolean,default:!0}},data:function(){return{outerWidth:0,outerHeight:0,innerLeft:0,innerBottom:0,mapScales:{}}},computed:{innerWidth:function(){return this.overview?this.outerWidth:1024},innerHeight:function(){return this.overview?this.outerHeight:896},wrapperSize:function(){return{width:this.outerWidth+"px",height:this.outerHeight+"px"}},focusPoint:function(){return void 0!=this.focus?this.datas[this.focus]:null!==(t=this.datas.find((function(t){return t.focus})))&&void 0!==t?t:this.datas[0];var t},innerStyle:function(){var t={width:this.innerWidth+"px",height:this.innerHeight+"px"};if(this.overview)return t;var e=this.offsetLimit(this.innerLeft,this.innerBottom),i=e.left,a=e.bottom;return Object(n["a"])(Object(n["a"])({},t),{},{left:i+"px",bottom:a+"px"})},subId:function(){var t=this.mapScales[this.mapId];if(!t||Object.keys(t)<=1)return 0;var e=0,i=0;for(var a in t){var s={x:t[a].StartX,y:t[a].StartY,width:t[a].Width/t[a].Scale,height:t[a].Height/t[a].Scale};this.isPointsInRect(s)&&t[a].Scale>i&&(e=a,i=t[a].Scale)}return e},mapName:function(){var t,e;return null===(t=this.mapScales[this.mapId])||void 0===t||null===(e=t[this.subId])||void 0===e?void 0:e.Name},mapScale:function(){var t;return null===(t=this.mapScales[this.mapId])||void 0===t?void 0:t[this.subId]},mapImg:function(){return"".concat(r.__imgPath,"map/maps/map_").concat(this.mapId,"_").concat(this.subId,".png")}},mounted:function(){this.fetchMapScales(),this.$nextTick((function(){this.bindUpdateSizeListener(),this.bindDraggerListener()}))},beforeDestroy:function(){window.removeEventListener("resize",this.updateSize)},methods:{pointPosition:function(t){var e=this.mapScale;if(!e)return{left:0,bottom:0};var i=e.Width/e.Scale,a=e.Height/e.Scale,s=(t.x-e.StartX)/i*this.innerWidth,n=(t.y-e.StartY)/a*this.innerHeight;return{left:s,bottom:n}},gamePosition:function(t,e){var i=this.mapScale;if(!i)return{x:0,y:0};var a=i.Width/i.Scale,s=i.Height/i.Scale,n=t/this.innerWidth*a+i.StartX,r=e/this.innerHeight*s+i.StartY;return{x:n,y:r}},pointStyle:function(t){var e=this.pointPosition(t),i=e.left,a=e.bottom;return{left:i+"px",bottom:a+"px"}},isPointsInRect:function(t){var e=this.datas.map((function(t){return{x:t.x,y:t.y}}));return e.every((function(e){return e.x>=t.x&&e.x<=t.x+t.width&&e.y>=t.y&&e.y<=t.y+t.height}))},initInnerOffset:function(t){if(this.overview)return{x:0,y:0};var e={x:this.outerWidth/2,y:this.outerHeight/2},i=this.pointPosition(t);this.innerLeft=e.x-i.left,this.innerBottom=e.y-i.bottom},fetchMapScales:function(){var t=this;c().then((function(e){t.mapScales=e,t.initInnerOffset(t.focusPoint)}))},updateSize:function(){var t;if(this.outerWidth=null===(t=this.$refs["component"])||void 0===t?void 0:t.clientWidth,this.outerWidth){var e;if(this.overview)this.outerHeight=this.outerWidth/(1024/896);else this.outerHeight=null===(e=this.$refs["component"])||void 0===e?void 0:e.clientHeight;this.$emit("resize",[this.outerWidth,this.outerHeight])}},bindUpdateSizeListener:function(){var t=this.$refs["component"];t&&(this.updateSize(),t.addEventListener("resize",this.updateSize))},bindDraggerListener:function(){var t=this;if(this.mapDraggable||this.pointDraggable){var e=this.$refs["wrapper"];if(e){var i={},a=function(t){var e=t.target;while(!e.classList.contains("u-map__wrapper")){if(e.classList.contains("u-map-point__wrapper"))return i.pointIndex=Number(e.dataset["index"]),!0;e=e.parentNode}return!1},s=function(e){var a=e.clientX,s=e.clientY;i.dx=a-i.x,i.dy=i.y-s;var n=t.offsetLimit(i.px+i.dx,i.py+i.dy),r=n.left,o=n.bottom;t.innerLeft=r,t.innerBottom=o},n=function(e){var a=e.clientX,s=e.clientY,n=t.datas[i.pointIndex],r=t.mapScale;i.dx=(a-i.x)/r.Scale,i.dy=(i.y-s)/r.Scale;var o=t.positionLimit(i.px+i.dx,i.py+i.dy),c=o.x,l=o.y;n.x=c,n.y=l},r=function(e){i={};var r=e.clientX,c=e.clientY;if(i.x=r,i.y=c,a(e)){if(!t.pointDraggable)return;i.point=t.datas[i.pointIndex],i.type="point-move",i.px=i.point.x,i.py=i.point.y,document.addEventListener("mousemove",n),document.addEventListener("mouseup",o)}else{if(!t.mapDraggable)return;i.type="map-move",i.px=t.innerLeft,i.py=t.innerBottom,document.addEventListener("mousemove",s),document.addEventListener("mouseup",o)}},o=function e(){document.removeEventListener("mousemove",s),document.removeEventListener("mousemove",n),document.removeEventListener("mouseup",e),(i.dx||i.dy)&&(t.$emit(i.type,i),t.mapFollow&&"point-move"==i.type&&t.initInnerOffset(i.point))};e.addEventListener("mousedown",r)}}},offsetLimit:function(t,e){var i=0,a=this.outerWidth-this.innerWidth,s=0,n=this.outerHeight-this.innerHeight;return{left:Math.max(Math.min(t,i),a),bottom:Math.max(Math.min(e,s),n)}},positionLimit:function(t,e){var i=this.mapScale.StartX,a=this.mapScale.StartX+this.mapScale.Width/this.mapScale.Scale-1024,s=this.mapScale.StartY,n=this.mapScale.StartY+this.mapScale.Height/this.mapScale.Scale-1024;return{x:Math.max(Math.min(t,a),i),y:Math.max(Math.min(e,n),s)}}}},u=l,d=(i("c2ba"),i("2877")),p=Object(d["a"])(u,a,s,!1,null,"17f22fc4",null);e["a"]=p.exports},ade3:function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var a=i("53ca");i("a4d3"),i("e01a"),i("8172"),i("d9e2"),i("efec"),i("a9e3"),i("d3b7");function s(t,e){if("object"!=Object(a["a"])(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var s=i.call(t,e||"default");if("object"!=Object(a["a"])(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function n(t){var e=s(t,"string");return"symbol"==Object(a["a"])(e)?e:String(e)}function r(t,e,i){return e=n(e),e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}},c2ba:function(t,e,i){"use strict";i("03a6")},dd43:function(t,e,i){"use strict";i("dfc2")},dfc2:function(t,e,i){},efec:function(t,e,i){"use strict";var a=i("1a2d"),s=i("cb2d"),n=i("51eb"),r=i("b622"),o=r("toPrimitive"),c=Date.prototype;a(c,o)||s(c,o,n)},f252:function(t,e,i){"use strict";i.d(e,"b",(function(){return u})),i.d(e,"f",(function(){return n})),i.d(e,"e",(function(){return r})),i.d(e,"a",(function(){return o})),i.d(e,"c",(function(){return c})),i.d(e,"d",(function(){return l})),i.d(e,"g",(function(){return d}));var a=i("41cb"),s=Object(a["d"])();function n(t){return s.get("/horses",{params:t})}function r(t){return s.get("/horse",{params:t})}function o(t){return s.get("/horse/attrs",{params:t})}function c(t){return s.get("/horse/feeds",{params:t})}function l(t){return Object(a["c"])().get("/api/game/reporter/horse",{params:t})}function u(t){var e={pageIndex:1,pageSize:50,server:t,type:"chitu-horse",subtype:"share_msg"};return Object(a["c"])().get("/api/game/reporter/horse",{params:e})}function d(){return Object(a["a"])().get("/api/cms/user/my/info")}}}]);
//# sourceMappingURL=chunk-db51ca06.f27bb32c.js.map