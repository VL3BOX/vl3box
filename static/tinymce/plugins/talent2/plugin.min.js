tinymce.PluginManager.add("talent2", function (editor, url) {
    var t = editor.translate;
    var openDialog = function () {
        return editor.windowManager.open({
            title: t("插入镇派方案"),
            body: {
                type: "panel",
                items: [
                    {
                        type: "textarea",
                        name: "talent2",
                        label: `<p>💙 ${t('请填入')}<a target="_blank" href="/app/talent2">${t('镇派模拟器')}</a>${t('生成的编码')}</p>`,
                    },
                ],
            },
            buttons: [
                {
                    type: "cancel",
                    text: t("取消"),
                },
                {
                    type: "submit",
                    text: t("插入"),
                    primary: true,
                },
            ],
            onSubmit: function (api) {
                var data = api.getData();

                // 包裹内容
                let prefix = '<pre class="e-jx3talent2-area">'
                let suffix = '</pre>'

                // 将输入框内容插入到内容区光标位置
                editor.insertContent(`${prefix}${data.talent2}${suffix}`);
                api.close();
            },
        });
    };

    // 注册一个工具栏按钮名称
    editor.ui.registry.addButton("talent2", {
        icon : 'talent2',
        tooltip: t("插入镇派方案"),
        // text: '插入视频',
        onAction: function () {
            openDialog();
        },
    });

    // 注册一个菜单项名称 menu/menubar
    // editor.ui.registry.addMenuItem("talent2", {
    //     text: "Example菜单名",
    //     onAction: function () {
    //         openDialog();
    //     },
    // });

    return {
        getMetadata: function () {
            return {
                //插件名和链接会显示在“帮助”→“插件”→“已安装的插件”中
                name: "talent2", //插件名称
                url: "https://github.com/JX3BOX", //作者网址
            };
        },
    };
});
